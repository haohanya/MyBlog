<!DOCTYPE html>
<html>
<head>
<link rel="shortcut icon" href="https://haohanya.github.io/favicon.ico" type="image/x-icon" /><meta name="viewport"content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/><meta name="apple-mobile-web-app-capable"content="yes"/><meta name="apple-mobile-web-app-status-bar-style"content="black"/><meta name="format-detection"content="telephone=no"/><meta name="renderer"content="webkit"><meta name="description"content="æµ©ç€š-æ¯å¤©å‘å¾€ç€å¤–é¢çš„ä¸–ç•Œ"><meta charset="UTF-8"><title> ElasticSearchï¼ˆä¸€ï¼‰ | æµ©ç€š</title>
<link href="https://haohanya.github.io/styles/main.css" type="text/css" rel="stylesheet" /><link href="https://at.alicdn.com/t/font_1621793_zatzzgvf30g.css" type="text/css" rel="stylesheet" /><link rel="stylesheet" href="https://haohanya.github.io/media/css/katex.css"><script async src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.min.js"></script><script src="https://haohanya.github.io/media/js/magnify.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
<script type="text/javascript">function btn_toggle(){document.getElementById("hn").classList.contains("no-js")?document.getElementById("hn").classList.remove("no-js"):document.getElementById("hn").classList.add("no-js")}</script>

<link rel="canonical" href="https://haohanya.github.io/post/elasticsearch1/" />
</head>
<body>
<div class="progress"></div><style>.progress{background:linear-gradient(to right,#87ceeb var(--scroll),transparent 0);background-repeat:no-repeat;position:fixed;width:100%;height:4px;z-index:1}</style><div class="darkmode-background"></div><div class="darkmode-layer"></div>
<noscript><p class="warn" >æœ¬é¡µé¢éœ€è¦æµè§ˆå™¨æ”¯æŒï¼ˆå¯ç”¨ï¼‰JavaScript</p></noscript><div class="header"><div class="logo_title"><div class="title animated fadeInDown"><a href="https://haohanya.github.io"><img alt="logo" style="display:inline-block;" src="https://haohanya.github.io/images/avatar.png"/></a><h1 title="æµ©ç€š" class="weaklink"><a  href="/">æµ©ç€š</a></h1>

<style>.santa-body{float:left;margin:10.5px 7.5px 0px 0px;font-size:20px;color:#f91047;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;width:1em;height:1em;background-color:currentColor;-webkit-box-shadow:inset 0 -0.25em rgba(0,0,0,0.1);box-shadow:inset 0 -0.25em rgba(0,0,0,0.1);border-radius:50%;-webkit-transform-origin:center bottom;-ms-transform-origin:center bottom;transform-origin:center bottom;-webkit-animation:balance alternate infinite 2s ease-in-out;animation:balance alternate infinite 2s ease-in-out;}.santa-head{font-size:.4em;width:1em;height:1.9em;background-color:white;border-radius:.5em;-webkit-transform:translateY(-1em);-ms-transform:translateY(-1em);transform:translateY(-1em);position:relative;}.santa-head::before{content:'';width:1em;height:.375em;display:block;background-color:#ff9876;position:absolute;left:0;top:.65em;}.santa-ear{background-color:#fc8363;width:.1em;height:.3em;position:absolute;top:.75em;}.santa-ear:nth-of-type(1){border-radius:.05em 0 0 .05em;left:-0.1em;}.santa-ear:nth-of-type(2){border-radius:0 .05em .05em 0;right:-0.1em;}.santa-hat{content:'';width:1em;height:.15em;position:absolute;-webkit-transform:scale(1.1);-ms-transform:scale(1.1);transform:scale(1.1);top:.5em;left:0;background-color:white;}.santa-hat::before{content:'';display:block;width:1em;height:.5em;background:#f91047;border-radius:.5em .5em 0 0;z-index:2;position:absolute;top:-0.5em;}.santa-hat::after{content:'';width:.25em;height:.25em;display:block;background-color:white;border-radius:50%;position:absolute;z-index:0;top:-0.72em;right:0;-webkit-box-shadow:-0.2em .2em 0 .12em rgba(0,0,0,0.2),-0.2em .2em 0 .12em #f91047;box-shadow:-0.2em .2em 0 .12em rgba(0,0,0,0.2),-0.2em .2em 0 .12em #f91047;}.santa-eye{width:.12em;height:.12em;background-color:black;border-radius:50%;position:absolute;top:.76em;left:.2em;}.santa-eye + .santa-eye{left:auto;right:.2em;}.santa-nose{width:.12em;height:.22em;background-color:#f24c4c;border-radius:0 0 .12em .12em;position:absolute;top:.84em;left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);}.santa-mouth{width:.18em;height:.1em;border-bottom-right-radius:5vw;border-bottom-left-radius:5vw;margin-top:.3em;background-color:black;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-animation:hohoho 4s linear forwards infinite;animation:hohoho 4s linear forwards infinite;}@-webkit-keyframes hohoho{0%,10%,20%,40%,100%{width:.18em;height:.1em;border-bottom-right-radius:1vw;border-bottom-left-radius:1vw;}5%,15%,25%,35%{width:.15em;height:.2em;border-radius:50%;}}@keyframes hohoho{0%,10%,20%,40%,100%{width:.18em;height:.1em;border-bottom-right-radius:1vw;border-bottom-left-radius:1vw;}5%,15%,25%,35%{width:.15em;height:.2em;border-radius:50%;}}@-webkit-keyframes balance{from{-webkit-transform:rotate(-4deg);transform:rotate(-4deg);}to{-webkit-transform:rotate(4deg);transform:rotate(4deg);}}@keyframes balance{from{-webkit-transform:rotate(-4deg);transform:rotate(-4deg);}to{-webkit-transform:rotate(4deg);transform:rotate(4deg);}}</style>
<div class="santa"><div class="santa-body"><div class="santa-head"><div class="santa-ear"></div><div class="santa-ear"></div><div class="santa-hat"></div><div class="santa-eye"></div><div class="santa-eye"></div><div class="santa-nose"></div><div class="santa-mouth"></div></div></div></div>

<div class="navbar weaklink">
<div class="normal_nav">
<div class="bitcron_nav_container"><div class="bitcron_nav"><div class="bitcron_nav"><div style="display:flex;justify-content:center;"><nav class="mixed_site_nav_wrap site_nav_wrap"><ul class="mixed_site_nav site_nav sm sm-base">	<li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/" class="selected active current nav__item" >é¦–é¡µ</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/archives" class="selected active current nav__item" >å½’æ¡£</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tags" class="selected active current nav__item" >æ ‡ç­¾</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/about" class="selected active current nav__item" >å…³äº</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://ucuser.cn/links/" class="selected active current nav__item" >å‹æƒ…é“¾æ¥</a></li></ul></nav>
<div style="float:right;margin-top:1em"><form id="gridea-search-form" data-update="1578893743252" action="/search/index.html"><input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="Search..."></form></div><div style="margin-left:0.5em;margin-top:1.2em"><input id="switch_default" onclick="mobileBtn()" type="checkbox" class="switch_default"><label for="switch_default" class="toggleBtn"></label></div></div>
<div class="clear clear_nav_inline_end"></div></div></div><div class="clear clear_nav_end"></div></div></div><div class="hamberger" href="javascript:void(0)" onclick="btn_toggle();"><i class="iconfont icon-category"></i></div></div></div></div>
<div id="hn" class="no-js hidden_nav animated fadeInDown"><div class="bitcron_nav_container"><div class="bitcron_nav"><nav class="mixed_site_nav_wrap site_nav_wrap"><ul class="mixed_site_nav site_nav sm sm-base">	<li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/" class="selected active current nav__item" >é¦–é¡µ</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/archives" class="selected active current nav__item" >å½’æ¡£</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tags" class="selected active current nav__item" >æ ‡ç­¾</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/about" class="selected active current nav__item" >å…³äº</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://ucuser.cn/links/" class="selected active current nav__item" >å‹æƒ…é“¾æ¥</a></li></ul><div class="clear clear_nav_inline_end"></div></nav></div><div class="clear clear_nav_end"></div></div>
<div style="display:flex;justify-content:center;inline-block;text-align:center;margin-top:7%"><div><form id="gridea-search-form" data-update="1594831539720" action="/search/index.html"><input class="search-input" autocomplete="off" spellcheck="false" name="q"  placeholder="Search..." /></form></div><div style="margin-left:0.5em"><input id="switch_default_h" onclick="mobileBtn()" type="checkbox" class="switch_default"><label for="switch_default" class="toggleBtn"></label></div></div>
</div></div>
<script>function enableDarkmode(){document.body.classList.add("darkmode"),document.getElementById("switch_default").checked=1,document.getElementById("switch_default_h").checked=1}function removeDarkmode(){document.body.classList.remove("darkmode"),document.getElementById("switch_default").checked=0,document.getElementById("switch_default_h").checked=0}function getCookie(a){var b,c=new RegExp("(^| )"+a+"=([^;]*)(;|$)");return(b=document.cookie.match(c))?unescape(b[2]):null}cookie=getCookie("darkmode"),"enable"==cookie&&enableDarkmode(),window.matchMedia("(prefers-color-scheme: dark)").matches&&"disable"!==cookie&&(enableDarkmode(),document.cookie="darkmode=enable; path=/");var mobileBtn=function(){1==document.getElementById("switch_default").checked?(enableDarkmode(),document.cookie="darkmode=enable; path=/"):(removeDarkmode(),document.cookie="darkmode=disable; path=/")};</script>

<div class="main"><div class="main-inner"><div class="content">
<article class="post">
<h2 class="post_title sm_margin"><a> ElasticSearchï¼ˆä¸€ï¼‰</a></h2>
<script>function lan(){if(document.getElementById("lan").innerText=="ç¹"){var s=document.getElementById("tongwenlet_cn");if(s!=null){document.body.removeChild(s)}var s=document.createElement("script");s.language="javascript";s.type="text/javascript";s.src="https://cdn.jsdelivr.net/gh/qyxtim/Static@1.1/bookmarklet_tw.js";s.id="tongwenlet_cn";document.body.appendChild(s);document.getElementById("lan").innerHTML="ç®€"}else{if(document.getElementById("lan").innerText=="ç°¡"){var s=document.getElementById("tongwenlet_cn");if(s!=null){document.body.removeChild(s)}var s=document.createElement("script");s.language="javascript";s.type="text/javascript";s.src="https://cdn.jsdelivr.net/gh/qyxtim/Static@1.1/bookmarklet_cn.js";s.id="tongwenlet_cn";document.body.appendChild(s);document.getElementById("lan").innerHTML="ç¹"}}};</script>
<section class="post_details"><i class="iconfont icon-calendar"></i><span style="margin-right:15px"> 2020-07-11</span><i class="iconfont icon-browse"></i><span style="margin-right:15px"> <span id="busuanzi_value_page_pv"></span> Views</span><i class="iconfont icon-category"></i><span class="weaklink" style="margin-right:15px">	<a href="https://haohanya.github.io/tag/cubgb1j5P/" class="tag">ElasticSearch</a></span><i class="iconfont icon-caret-down"></i><span style="margin-right:15px">8562å­—</span><i class="iconfont icon-naozhong"></i><span style="margin-right:15px">35 min read</span><a id="lan" href="javascript:void(0);"onclick="lan();"title="è°ƒæ•´ç®€ç¹ä½“" style="margin-right:15px;">ç¹</a>
</section>

<div style="display:flex">
<div class="md_block" id="md_block">
<div class="round-shape-one"></div>
<h2 id="elasticsearchç®€ä»‹">ElasticSearchç®€ä»‹</h2>
<h3 id="ä»€ä¹ˆæ˜¯elasticsearch">ä»€ä¹ˆæ˜¯ElasticSearch</h3>
<p>Elaticsearchï¼Œç®€ç§°ä¸ºesï¼Œ esæ˜¯ä¸€ä¸ªå¼€æºçš„é«˜æ‰©å±•çš„åˆ†å¸ƒå¼å…¨æ–‡æ£€ç´¢å¼•æ“ï¼Œå®ƒå¯ä»¥è¿‘ä¹å®æ—¶çš„å­˜å‚¨ã€æ£€ç´¢æ•°æ®ï¼›æœ¬<br>
èº«æ‰©å±•æ€§å¾ˆå¥½ï¼Œå¯ä»¥æ‰©å±•åˆ°ä¸Šç™¾å°æœåŠ¡å™¨ï¼Œå¤„ç†PBçº§åˆ«çš„æ•°æ®ã€‚esä¹Ÿä½¿ç”¨Javaå¼€å‘å¹¶ä½¿ç”¨Luceneä½œä¸ºå…¶æ ¸å¿ƒæ¥å®<br>
ç°æ‰€æœ‰ç´¢å¼•å’Œæœç´¢çš„åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒçš„ç›®çš„æ˜¯é€šè¿‡ç®€å•çš„RESTful APIæ¥éšè—Luceneçš„å¤æ‚æ€§ï¼Œä»è€Œè®©å…¨æ–‡æœç´¢å˜å¾—<br>
ç®€å•ã€‚</p>
<h3 id="elasticsearchçš„ä½¿ç”¨æ¡ˆä¾‹">ElasticSearchçš„ä½¿ç”¨æ¡ˆä¾‹</h3>
<ul>
<li>2013å¹´åˆï¼ŒGitHubæŠ›å¼ƒäº†Solrï¼Œé‡‡å–ElasticSearch æ¥åšPBçº§çš„æœç´¢ã€‚ â€œGitHubä½¿ç”¨ElasticSearchæœç´¢20TB<br>
çš„æ•°æ®ï¼ŒåŒ…æ‹¬13äº¿æ–‡ä»¶å’Œ1300äº¿è¡Œä»£ç â€</li>
<li>ç»´åŸºç™¾ç§‘ï¼šå¯åŠ¨ä»¥elasticsearchä¸ºåŸºç¡€çš„æ ¸å¿ƒæœç´¢æ¶æ„</li>
<li>SoundCloudï¼šâ€œSoundCloudä½¿ç”¨ElasticSearchä¸º1.8äº¿ç”¨æˆ·æä¾›å³æ—¶è€Œç²¾å‡†çš„éŸ³ä¹æœç´¢æœåŠ¡â€</li>
<li>ç™¾åº¦ï¼šç™¾åº¦ç›®å‰å¹¿æ³›ä½¿ç”¨ElasticSearchä½œä¸ºæ–‡æœ¬æ•°æ®åˆ†æï¼Œé‡‡é›†ç™¾åº¦æ‰€æœ‰æœåŠ¡å™¨ä¸Šçš„å„ç±»æŒ‡æ ‡æ•°æ®åŠç”¨æˆ·è‡ª<br>
å®šä¹‰æ•°æ®ï¼Œé€šè¿‡å¯¹å„ç§æ•°æ®è¿›è¡Œå¤šç»´åˆ†æå±•ç¤ºï¼Œè¾…åŠ©å®šä½åˆ†æå®ä¾‹å¼‚å¸¸æˆ–ä¸šåŠ¡å±‚é¢å¼‚å¸¸ã€‚ç›®å‰è¦†ç›–ç™¾åº¦å†…éƒ¨<br>
20å¤šä¸ªä¸šåŠ¡çº¿ï¼ˆåŒ…æ‹¬casioã€äº‘åˆ†æã€ç½‘ç›Ÿã€é¢„æµ‹ã€æ–‡åº“ã€ç›´è¾¾å·ã€é’±åŒ…ã€é£æ§ç­‰ï¼‰ï¼Œå•é›†ç¾¤æœ€å¤§100å°æœº<br>
å™¨ï¼Œ200ä¸ªESèŠ‚ç‚¹ï¼Œæ¯å¤©å¯¼å…¥30TB+æ•°æ®</li>
<li>æ–°æµªä½¿ç”¨ES åˆ†æå¤„ç†32äº¿æ¡å®æ—¶æ—¥å¿—</li>
<li>é˜¿é‡Œä½¿ç”¨ES æ„å»ºæŒ–è´¢è‡ªå·±çš„æ—¥å¿—é‡‡é›†å’Œåˆ†æä½“ç³»</li>
</ul>
<h3 id="elasticsearchå¯¹æ¯”solr">ElasticSearchå¯¹æ¯”Solr</h3>
<ul>
<li>Solr åˆ©ç”¨ Zookeeper è¿›è¡Œåˆ†å¸ƒå¼ç®¡ç†ï¼Œè€Œ Elasticsearch è‡ªèº«å¸¦æœ‰åˆ†å¸ƒå¼åè°ƒç®¡ç†åŠŸèƒ½;</li>
<li>Solr æ”¯æŒæ›´å¤šæ ¼å¼çš„æ•°æ®ï¼Œè€Œ Elasticsearch ä»…æ”¯æŒjsonæ–‡ä»¶æ ¼å¼ï¼›</li>
<li>Solr å®˜æ–¹æä¾›çš„åŠŸèƒ½æ›´å¤šï¼Œè€Œ Elasticsearch æœ¬èº«æ›´æ³¨é‡äºæ ¸å¿ƒåŠŸèƒ½ï¼Œé«˜çº§åŠŸèƒ½å¤šæœ‰ç¬¬ä¸‰æ–¹æ’ä»¶æä¾›ï¼›</li>
<li>Solr åœ¨ä¼ ç»Ÿçš„æœç´¢åº”ç”¨ä¸­è¡¨ç°å¥½äº Elasticsearchï¼Œä½†åœ¨å¤„ç†å®æ—¶æœç´¢åº”ç”¨æ—¶æ•ˆç‡æ˜æ˜¾ä½äº Elasticsearch</li>
</ul>
<h2 id="elasticsearchå®‰è£…ä¸å¯åŠ¨">ElasticSearchå®‰è£…ä¸å¯åŠ¨</h2>
<h3 id="ä¸‹è½½eså‹ç¼©åŒ…">ä¸‹è½½ESå‹ç¼©åŒ…</h3>
<p>ElasticSearchåˆ†ä¸ºLinuxå’ŒWindowç‰ˆæœ¬ï¼ŒåŸºäºæˆ‘ä»¬ä¸»è¦å­¦ä¹ çš„æ˜¯ElasticSearchçš„Javaå®¢æˆ·ç«¯çš„ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è¯¾<br>
ç¨‹ä¸­ä½¿ç”¨çš„æ˜¯å®‰è£…è¾ƒä¸ºç®€ä¾¿çš„Windowç‰ˆæœ¬ï¼Œé¡¹ç›®ä¸Šçº¿åï¼Œå…¬å¸çš„è¿ç»´äººå‘˜ä¼šå®‰è£…Linuxç‰ˆçš„ESä¾›æˆ‘ä»¬è¿æ¥ä½¿ç”¨ã€‚<br>
ElasticSearchçš„å®˜æ–¹åœ°å€ï¼š https://www.elastic.co/products/elasticsearch</p>
<h3 id="å®‰è£…esæœåŠ¡">å®‰è£…ESæœåŠ¡</h3>
<p>Windowç‰ˆçš„ElasticSearchçš„å®‰è£…å¾ˆç®€å•ï¼Œç±»ä¼¼Windowç‰ˆçš„Tomcatï¼Œè§£å‹å¼€å³å®‰è£…å®Œæ¯•ï¼Œè§£å‹åçš„ElasticSearch<br>
çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure data-type="image" tabindex="1"><img src="https://haohanya.github.io/post-images/1594482264761.png" alt="" loading="lazy"></figure>
<p>ä¿®æ”¹elasticsearché…ç½®æ–‡ä»¶ï¼šconfig/elasticsearch.ymlï¼Œå¢åŠ ä»¥ä¸‹ä¸¤å¥å‘½ä»¤ï¼š</p>
<pre><code class="language-yaml">http.cors.enabled:Â true
http.cors.allowâ€origin:Â &quot;*&quot;
</code></pre>
<blockquote>
<p>æ­¤æ­¥ä¸ºå…è®¸elasticsearchè·¨è¶Šè®¿é—®ï¼Œå¦‚æœä¸å®‰è£…åé¢çš„elasticsearch-headæ˜¯å¯ä»¥ä¸ä¿®æ”¹ï¼Œç›´æ¥å¯åŠ¨ã€‚</p>
</blockquote>
<h3 id="å¯åŠ¨esæœåŠ¡">å¯åŠ¨ESæœåŠ¡</h3>
<p>ç‚¹å‡»ElasticSearchä¸‹çš„binç›®å½•ä¸‹çš„elasticsearch.batå¯åŠ¨</p>
<figure data-type="image" tabindex="2"><img src="https://haohanya.github.io/post-images/1594482281436.png" alt="" loading="lazy"></figure>
<blockquote>
<p>æ³¨æ„ï¼š9300æ˜¯tcpé€šè®¯ç«¯å£ï¼Œé›†ç¾¤é—´å’ŒTCPClientéƒ½æ‰§è¡Œè¯¥ç«¯å£ï¼Œ9200æ˜¯httpåè®®çš„RESTfulæ¥å£ ã€‚<br>
é€šè¿‡æµè§ˆå™¨è®¿é—®ElasticSearchæœåŠ¡å™¨ï¼Œçœ‹åˆ°å¦‚ä¸‹è¿”å›çš„jsonä¿¡æ¯ï¼Œä»£è¡¨æœåŠ¡å¯åŠ¨æˆåŠŸï¼š</p>
</blockquote>
<figure data-type="image" tabindex="3"><img src="https://haohanya.github.io/post-images/1594482295427.png" alt="" loading="lazy"></figure>
<blockquote>
<p>æ³¨æ„ï¼šElasticSearchæ˜¯ä½¿ç”¨javaå¼€å‘çš„ï¼Œä¸”æœ¬ç‰ˆæœ¬çš„eséœ€è¦çš„jdkç‰ˆæœ¬è¦æ˜¯1.8ä»¥ä¸Šï¼Œæ‰€ä»¥å®‰è£…ElasticSearchä¹‹å‰ä¿<br>
è¯JDK1.8+å®‰è£…å®Œæ¯•ï¼Œå¹¶æ­£ç¡®çš„é…ç½®å¥½JDKç¯å¢ƒå˜é‡ï¼Œå¦åˆ™å¯åŠ¨ElasticSearchå¤±è´¥ã€‚</p>
</blockquote>
<h3 id="å®‰è£…esçš„å›¾å½¢åŒ–ç•Œé¢æ’ä»¶">å®‰è£…ESçš„å›¾å½¢åŒ–ç•Œé¢æ’ä»¶</h3>
<p>ElasticSearchä¸åŒäºSolrè‡ªå¸¦å›¾å½¢åŒ–ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®‰è£…ElasticSearchçš„headæ’ä»¶ï¼Œå®Œæˆå›¾å½¢åŒ–ç•Œé¢çš„æ•ˆ<br>
æœï¼Œå®Œæˆç´¢å¼•æ•°æ®çš„æŸ¥çœ‹ã€‚å®‰è£…æ’ä»¶çš„æ–¹å¼æœ‰ä¸¤ç§ï¼Œåœ¨çº¿å®‰è£…å’Œæœ¬åœ°å®‰è£…ã€‚æœ¬æ–‡æ¡£é‡‡ç”¨æœ¬åœ°å®‰è£…æ–¹å¼è¿›è¡Œheadæ’<br>
ä»¶çš„å®‰è£…ã€‚elasticsearch-5-*ä»¥ä¸Šç‰ˆæœ¬å®‰è£…headéœ€è¦å®‰è£…nodeå’Œgrunt</p>
<ol>
<li>
<p>ä¸‹è½½headæ’ä»¶ï¼šhttps://github.com/mobz/elasticsearch-head</p>
</li>
<li>
<p>å°†elasticsearch-head-masterå‹ç¼©åŒ…è§£å‹åˆ°ä»»æ„ç›®å½•ï¼Œä½†æ˜¯è¦å’Œelasticsearchçš„å®‰è£…ç›®å½•åŒºåˆ«å¼€</p>
</li>
<li>
<p>ä¸‹è½½nodejsï¼šhttps://nodejs.org/en/download/</p>
</li>
<li>
<p>å°†gruntå®‰è£…ä¸ºå…¨å±€å‘½ä»¤ ï¼ŒGruntæ˜¯åŸºäºNode.jsçš„é¡¹ç›®æ„å»ºå·¥å…·</p>
<blockquote>
<p>npm install â€g grunt â€cli</p>
</blockquote>
</li>
<li>
<p>è¿›å…¥elasticsearch-head-masterç›®å½•å¯åŠ¨headï¼Œåœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹è¾“å…¥å‘½ä»¤</p>
<blockquote>
<p>npm install</p>
<p>grunt server</p>
</blockquote>
</li>
<li>
<p>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ http://localhost:9100ï¼Œçœ‹åˆ°å¦‚ä¸‹é¡µé¢</p>
</li>
</ol>
<figure data-type="image" tabindex="4"><img src="https://haohanya.github.io/post-images/1594482438142.png" alt="" loading="lazy"></figure>
<h2 id="elasticsearchç›¸å…³æ¦‚å¿µæœ¯è¯­">ElasticSearchç›¸å…³æ¦‚å¿µ(æœ¯è¯­)</h2>
<h3 id="æ¦‚è¿°">æ¦‚è¿°</h3>
<p>Elasticsearchæ˜¯é¢å‘æ–‡æ¡£(document oriented)çš„ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥å­˜å‚¨æ•´ä¸ªå¯¹è±¡æˆ–æ–‡æ¡£(document)ã€‚ç„¶è€Œå®ƒä¸ä»…<br>
ä»…æ˜¯å­˜å‚¨ï¼Œè¿˜ä¼šç´¢å¼•(index)æ¯ä¸ªæ–‡æ¡£çš„å†…å®¹ä½¿ä¹‹å¯ä»¥è¢«æœç´¢ã€‚åœ¨Elasticsearchä¸­ï¼Œä½ å¯ä»¥å¯¹æ–‡æ¡£ï¼ˆè€Œéæˆè¡Œæˆåˆ—çš„<br>
æ•°æ®ï¼‰è¿›è¡Œç´¢å¼•ã€æœç´¢ã€æ’åºã€è¿‡æ»¤ã€‚Elasticsearchæ¯”ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>Relational DB â€&gt; Databases â€&gt; Tables â€&gt; Rows â€&gt; Columns<br>
Elasticsearch â€&gt; Indices   â€&gt; Types  â€&gt; Documents â€&gt; Fields</p>
</blockquote>
<h3 id="elasticsearchæ ¸å¿ƒæ¦‚å¿µ">Elasticsearchæ ¸å¿ƒæ¦‚å¿µ</h3>
<h4 id="ç´¢å¼•-index">ç´¢å¼• index</h4>
<p>ä¸€ä¸ªç´¢å¼•å°±æ˜¯ä¸€ä¸ªæ‹¥æœ‰å‡ åˆ†ç›¸ä¼¼ç‰¹å¾çš„æ–‡æ¡£çš„é›†åˆã€‚æ¯”å¦‚è¯´ï¼Œä½ å¯ä»¥æœ‰ä¸€ä¸ªå®¢æˆ·æ•°æ®çš„ç´¢å¼•ï¼Œå¦ä¸€ä¸ªäº§å“ç›®å½•çš„ç´¢<br>
å¼•ï¼Œè¿˜æœ‰ä¸€ä¸ªè®¢å•æ•°æ®çš„ç´¢å¼•ã€‚ä¸€ä¸ªç´¢å¼•ç”±ä¸€ä¸ªåå­—æ¥æ ‡è¯†ï¼ˆå¿…é¡»å…¨éƒ¨æ˜¯å°å†™å­—æ¯çš„ï¼‰ï¼Œå¹¶ä¸”å½“æˆ‘ä»¬è¦å¯¹å¯¹åº”äºè¿™<br>
ä¸ªç´¢å¼•ä¸­çš„æ–‡æ¡£è¿›è¡Œç´¢å¼•ã€æœç´¢ã€æ›´æ–°å’Œåˆ é™¤çš„æ—¶å€™ï¼Œéƒ½è¦ä½¿ç”¨åˆ°è¿™ä¸ªåå­—ã€‚åœ¨ä¸€ä¸ªé›†ç¾¤ä¸­ï¼Œå¯ä»¥å®šä¹‰ä»»æ„å¤šçš„ç´¢<br>
å¼•</p>
<h4 id="ç±»å‹-type">ç±»å‹ type</h4>
<p>åœ¨ä¸€ä¸ªç´¢å¼•ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ç§æˆ–å¤šç§ç±»å‹ã€‚ä¸€ä¸ªç±»å‹æ˜¯ä½ çš„ç´¢å¼•çš„ä¸€ä¸ªé€»è¾‘ä¸Šçš„åˆ†ç±»/åˆ†åŒºï¼Œå…¶è¯­ä¹‰å®Œå…¨ç”±ä½ æ¥<br>
å®šã€‚é€šå¸¸ï¼Œä¼šä¸ºå…·æœ‰ä¸€ç»„å…±åŒå­—æ®µçš„æ–‡æ¡£å®šä¹‰ä¸€ä¸ªç±»å‹ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å‡è®¾ä½ è¿è¥ä¸€ä¸ªåšå®¢å¹³å°å¹¶ä¸”å°†ä½ æ‰€æœ‰çš„æ•°<br>
æ®å­˜å‚¨åˆ°ä¸€ä¸ªç´¢å¼•ä¸­ã€‚åœ¨è¿™ä¸ªç´¢å¼•ä¸­ï¼Œä½ å¯ä»¥ä¸ºç”¨æˆ·æ•°æ®å®šä¹‰ä¸€ä¸ªç±»å‹ï¼Œä¸ºåšå®¢æ•°æ®å®šä¹‰å¦ä¸€ä¸ªç±»å‹ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯<br>
ä»¥ä¸ºè¯„è®ºæ•°æ®å®šä¹‰å¦ä¸€ä¸ªç±»å‹ã€‚</p>
<h4 id="å­—æ®µfield">å­—æ®µField</h4>
<p>ç›¸å½“äºæ˜¯æ•°æ®è¡¨çš„å­—æ®µï¼Œå¯¹æ–‡æ¡£æ•°æ®æ ¹æ®ä¸åŒå±æ€§è¿›è¡Œçš„åˆ†ç±»æ ‡è¯†</p>
<h4 id="æ˜ å°„-mapping">æ˜ å°„ mapping</h4>
<p>mappingæ˜¯å¤„ç†æ•°æ®çš„æ–¹å¼å’Œè§„åˆ™æ–¹é¢åšä¸€äº›é™åˆ¶ï¼Œå¦‚æŸä¸ªå­—æ®µçš„æ•°æ®ç±»å‹ã€é»˜è®¤å€¼ã€åˆ†æå™¨ã€æ˜¯å¦è¢«ç´¢å¼•ç­‰ç­‰ï¼Œ<br>
è¿™äº›éƒ½æ˜¯æ˜ å°„é‡Œé¢å¯ä»¥è®¾ç½®çš„ï¼Œå…¶å®ƒå°±æ˜¯å¤„ç†esé‡Œé¢æ•°æ®çš„ä¸€äº›ä½¿ç”¨è§„åˆ™è®¾ç½®ä¹Ÿå«åšæ˜ å°„ï¼ŒæŒ‰ç€æœ€ä¼˜è§„åˆ™å¤„ç†æ•°æ®<br>
å¯¹æ€§èƒ½æé«˜å¾ˆå¤§ï¼Œå› æ­¤æ‰éœ€è¦å»ºç«‹æ˜ å°„ï¼Œå¹¶ä¸”éœ€è¦æ€è€ƒå¦‚ä½•å»ºç«‹æ˜ å°„æ‰èƒ½å¯¹æ€§èƒ½æ›´å¥½</p>
<h4 id="æ–‡æ¡£-document">æ–‡æ¡£ document</h4>
<p>ä¸€ä¸ªæ–‡æ¡£æ˜¯ä¸€ä¸ªå¯è¢«ç´¢å¼•çš„åŸºç¡€ä¿¡æ¯å•å…ƒã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥æ‹¥æœ‰æŸä¸€ä¸ªå®¢æˆ·çš„æ–‡æ¡£ï¼ŒæŸä¸€ä¸ªäº§å“çš„ä¸€ä¸ªæ–‡æ¡£ï¼Œå½“ç„¶ï¼Œ<br>
ä¹Ÿå¯ä»¥æ‹¥æœ‰æŸä¸ªè®¢å•çš„ä¸€ä¸ªæ–‡æ¡£ã€‚æ–‡æ¡£ä»¥JSONï¼ˆJavascript Object Notationï¼‰æ ¼å¼æ¥è¡¨ç¤ºï¼Œè€ŒJSONæ˜¯ä¸€ä¸ªåˆ°å¤„å­˜<br>
åœ¨çš„äº’è”ç½‘æ•°æ®äº¤äº’æ ¼å¼ã€‚</p>
<p>åœ¨ä¸€ä¸ªindex/typeé‡Œé¢ï¼Œä½ å¯ä»¥å­˜å‚¨ä»»æ„å¤šçš„æ–‡æ¡£ã€‚æ³¨æ„ï¼Œå°½ç®¡ä¸€ä¸ªæ–‡æ¡£ï¼Œç‰©ç†ä¸Šå­˜åœ¨äºä¸€ä¸ªç´¢å¼•ä¹‹ä¸­ï¼Œæ–‡æ¡£å¿…é¡»<br>
è¢«ç´¢å¼•/èµ‹äºˆä¸€ä¸ªç´¢å¼•çš„typeã€‚</p>
<h4 id="æ¥è¿‘å®æ—¶-nrt">æ¥è¿‘å®æ—¶ NRT</h4>
<p>Elasticsearchæ˜¯ä¸€ä¸ªæ¥è¿‘å®æ—¶çš„æœç´¢å¹³å°ã€‚è¿™æ„å‘³ç€ï¼Œä»ç´¢å¼•ä¸€ä¸ªæ–‡æ¡£ç›´åˆ°è¿™ä¸ªæ–‡æ¡£èƒ½å¤Ÿè¢«æœç´¢åˆ°æœ‰ä¸€ä¸ªè½»å¾®çš„å»¶<br>
è¿Ÿï¼ˆé€šå¸¸æ˜¯1ç§’ä»¥å†…ï¼‰</p>
<h4 id="é›†ç¾¤-cluster">é›†ç¾¤ cluster</h4>
<p>ä¸€ä¸ªé›†ç¾¤å°±æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹ç»„ç»‡åœ¨ä¸€èµ·ï¼Œå®ƒä»¬å…±åŒæŒæœ‰æ•´ä¸ªçš„æ•°æ®ï¼Œå¹¶ä¸€èµ·æä¾›ç´¢å¼•å’Œæœç´¢åŠŸèƒ½ã€‚ä¸€ä¸ªé›†ç¾¤ç”±<br>
ä¸€ä¸ªå”¯ä¸€çš„åå­—æ ‡è¯†ï¼Œè¿™ä¸ªåå­—é»˜è®¤å°±æ˜¯â€œelasticsearchâ€ã€‚è¿™ä¸ªåå­—æ˜¯é‡è¦çš„ï¼Œå› ä¸ºä¸€ä¸ªèŠ‚ç‚¹åªèƒ½é€šè¿‡æŒ‡å®šæŸä¸ªé›†<br>
ç¾¤çš„åå­—ï¼Œæ¥åŠ å…¥è¿™ä¸ªé›†ç¾¤</p>
<h4 id="èŠ‚ç‚¹-node">èŠ‚ç‚¹ node</h4>
<p>ä¸€ä¸ªèŠ‚ç‚¹æ˜¯é›†ç¾¤ä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä½œä¸ºé›†ç¾¤çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå­˜å‚¨æ•°æ®ï¼Œå‚ä¸é›†ç¾¤çš„ç´¢å¼•å’Œæœç´¢åŠŸèƒ½ã€‚å’Œé›†ç¾¤ç±»ä¼¼ï¼Œä¸€<br>
ä¸ªèŠ‚ç‚¹ä¹Ÿæ˜¯ç”±ä¸€ä¸ªåå­—æ¥æ ‡è¯†çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªåå­—æ˜¯ä¸€ä¸ªéšæœºçš„æ¼«å¨æ¼«ç”»è§’è‰²çš„åå­—ï¼Œè¿™ä¸ªåå­—ä¼šåœ¨å¯åŠ¨çš„<br>
æ—¶å€™èµ‹äºˆèŠ‚ç‚¹ã€‚è¿™ä¸ªåå­—å¯¹äºç®¡ç†å·¥ä½œæ¥è¯´æŒºé‡è¦çš„ï¼Œå› ä¸ºåœ¨è¿™ä¸ªç®¡ç†è¿‡ç¨‹ä¸­ï¼Œä½ ä¼šå»ç¡®å®šç½‘ç»œä¸­çš„å“ªäº›æœåŠ¡å™¨å¯¹<br>
åº”äºElasticsearché›†ç¾¤ä¸­çš„å“ªäº›èŠ‚ç‚¹ã€‚</p>
<p>ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥é€šè¿‡é…ç½®é›†ç¾¤åç§°çš„æ–¹å¼æ¥åŠ å…¥ä¸€ä¸ªæŒ‡å®šçš„é›†ç¾¤ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šè¢«å®‰æ’åŠ å…¥åˆ°ä¸€ä¸ªå«<br>
åšâ€œelasticsearchâ€çš„é›†ç¾¤ä¸­ï¼Œè¿™æ„å‘³ç€ï¼Œå¦‚æœä½ åœ¨ä½ çš„ç½‘ç»œä¸­å¯åŠ¨äº†è‹¥å¹²ä¸ªèŠ‚ç‚¹ï¼Œå¹¶å‡å®šå®ƒä»¬èƒ½å¤Ÿç›¸äº’å‘ç°å½¼æ­¤ï¼Œ<br>
å®ƒä»¬å°†ä¼šè‡ªåŠ¨åœ°å½¢æˆå¹¶åŠ å…¥åˆ°ä¸€ä¸ªå«åšâ€œelasticsearchâ€çš„é›†ç¾¤ä¸­ã€‚</p>
<p>åœ¨ä¸€ä¸ªé›†ç¾¤é‡Œï¼Œåªè¦ä½ æƒ³ï¼Œå¯ä»¥æ‹¥æœ‰ä»»æ„å¤šä¸ªèŠ‚ç‚¹ã€‚è€Œä¸”ï¼Œå¦‚æœå½“å‰ä½ çš„ç½‘ç»œä¸­æ²¡æœ‰è¿è¡Œä»»ä½•ElasticsearchèŠ‚ç‚¹ï¼Œ<br>
è¿™æ—¶å¯åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¼šé»˜è®¤åˆ›å»ºå¹¶åŠ å…¥ä¸€ä¸ªå«åšâ€œelasticsearchâ€çš„é›†ç¾¤</p>
<h4 id="åˆ†ç‰‡å’Œå¤åˆ¶-shardsreplicas">åˆ†ç‰‡å’Œå¤åˆ¶ shards&amp;replicas</h4>
<p>ä¸€ä¸ªç´¢å¼•å¯ä»¥å­˜å‚¨è¶…å‡ºå•ä¸ªç»“ç‚¹ç¡¬ä»¶é™åˆ¶çš„å¤§é‡æ•°æ®ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªå…·æœ‰10äº¿æ–‡æ¡£çš„ç´¢å¼•å æ®1TBçš„ç£ç›˜ç©ºé—´ï¼Œè€Œä»»<br>
ä¸€èŠ‚ç‚¹éƒ½æ²¡æœ‰è¿™æ ·å¤§çš„ç£ç›˜ç©ºé—´ï¼›æˆ–è€…å•ä¸ªèŠ‚ç‚¹å¤„ç†æœç´¢è¯·æ±‚ï¼Œå“åº”å¤ªæ…¢ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒElasticsearchæä¾›<br>
äº†å°†ç´¢å¼•åˆ’åˆ†æˆå¤šä»½çš„èƒ½åŠ›ï¼Œè¿™äº›ä»½å°±å«åšåˆ†ç‰‡ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œä½ å¯ä»¥æŒ‡å®šä½ æƒ³è¦çš„åˆ†ç‰‡çš„æ•°é‡ã€‚æ¯<br>
ä¸ªåˆ†ç‰‡æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„å¹¶ä¸”ç‹¬ç«‹çš„â€œç´¢å¼•â€ï¼Œè¿™ä¸ªâ€œç´¢å¼•â€å¯ä»¥è¢«æ”¾ç½®åˆ°é›†ç¾¤ä¸­çš„ä»»ä½•èŠ‚ç‚¹ä¸Šã€‚åˆ†ç‰‡å¾ˆé‡è¦ï¼Œä¸»<br>
è¦æœ‰ä¸¤æ–¹é¢çš„åŸå› ï¼š</p>
<p>â€‹	1ï¼‰å…è®¸ä½ æ°´å¹³åˆ†å‰²/æ‰©å±•ä½ çš„å†…å®¹å®¹é‡ã€‚</p>
<p>â€‹	2ï¼‰å…è®¸ä½ åœ¨åˆ†ç‰‡ï¼ˆæ½œåœ¨åœ°ï¼Œä½äºå¤šä¸ªèŠ‚ç‚¹ä¸Šï¼‰ä¹‹ä¸Š</p>
<p>è¿›è¡Œåˆ†å¸ƒå¼çš„ã€å¹¶è¡Œçš„æ“ä½œï¼Œè¿›è€Œæé«˜æ€§èƒ½/ååé‡ã€‚<br>
è‡³äºä¸€ä¸ªåˆ†ç‰‡æ€æ ·åˆ†å¸ƒï¼Œå®ƒçš„æ–‡æ¡£æ€æ ·èšåˆå›æœç´¢è¯·æ±‚ï¼Œæ˜¯å®Œå…¨ç”±Elasticsearchç®¡ç†çš„ï¼Œå¯¹äºä½œä¸ºç”¨æˆ·çš„ä½ æ¥è¯´ï¼Œ<br>
è¿™äº›éƒ½æ˜¯é€æ˜çš„ã€‚</p>
<p>åœ¨ä¸€ä¸ªç½‘ç»œ/äº‘çš„ç¯å¢ƒé‡Œï¼Œå¤±è´¥éšæ—¶éƒ½å¯èƒ½å‘ç”Ÿï¼Œåœ¨æŸä¸ªåˆ†ç‰‡/èŠ‚ç‚¹ä¸çŸ¥æ€ä¹ˆçš„å°±å¤„äºç¦»çº¿çŠ¶æ€ï¼Œæˆ–è€…ç”±äºä»»ä½•åŸå› <br>
æ¶ˆå¤±äº†ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæœ‰ä¸€ä¸ªæ•…éšœè½¬ç§»æœºåˆ¶æ˜¯éå¸¸æœ‰ç”¨å¹¶ä¸”æ˜¯å¼ºçƒˆæ¨èçš„ã€‚ä¸ºæ­¤ç›®çš„ï¼ŒElasticsearchå…è®¸ä½ åˆ›å»ºåˆ†<br>
ç‰‡çš„ä¸€ä»½æˆ–å¤šä»½æ‹·è´ï¼Œè¿™äº›æ‹·è´å«åšå¤åˆ¶åˆ†ç‰‡ï¼Œæˆ–è€…ç›´æ¥å«å¤åˆ¶ã€‚</p>
<p>å¤åˆ¶ä¹‹æ‰€ä»¥é‡è¦ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦åŸå› ï¼š åœ¨åˆ†ç‰‡/èŠ‚ç‚¹å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œæä¾›äº†é«˜å¯ç”¨æ€§ã€‚å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæ³¨æ„åˆ°å¤åˆ¶åˆ†<br>
ç‰‡ä»ä¸ä¸åŸ/ä¸»è¦ï¼ˆoriginal/primaryï¼‰åˆ†ç‰‡ç½®äºåŒä¸€èŠ‚ç‚¹ä¸Šæ˜¯éå¸¸é‡è¦çš„ã€‚æ‰©å±•ä½ çš„æœç´¢é‡/ååé‡ï¼Œå› ä¸ºæœç´¢å¯ä»¥<br>
åœ¨æ‰€æœ‰çš„å¤åˆ¶ä¸Šå¹¶è¡Œè¿è¡Œã€‚æ€»ä¹‹ï¼Œæ¯ä¸ªç´¢å¼•å¯ä»¥è¢«åˆ†æˆå¤šä¸ªåˆ†ç‰‡ã€‚ä¸€ä¸ªç´¢å¼•ä¹Ÿå¯ä»¥è¢«å¤åˆ¶0æ¬¡ï¼ˆæ„æ€æ˜¯æ²¡æœ‰å¤åˆ¶ï¼‰<br>
æˆ–å¤šæ¬¡ã€‚ä¸€æ—¦å¤åˆ¶äº†ï¼Œæ¯ä¸ªç´¢å¼•å°±æœ‰äº†ä¸»åˆ†ç‰‡ï¼ˆä½œä¸ºå¤åˆ¶æºçš„åŸæ¥çš„åˆ†ç‰‡ï¼‰å’Œå¤åˆ¶åˆ†ç‰‡ï¼ˆä¸»åˆ†ç‰‡çš„æ‹·è´ï¼‰ä¹‹åˆ«ã€‚åˆ†<br>
ç‰‡å’Œå¤åˆ¶çš„æ•°é‡å¯ä»¥åœ¨ç´¢å¼•åˆ›å»ºçš„æ—¶å€™æŒ‡å®šã€‚åœ¨ç´¢å¼•åˆ›å»ºä¹‹åï¼Œä½ å¯ä»¥åœ¨ä»»ä½•æ—¶å€™åŠ¨æ€åœ°æ”¹å˜å¤åˆ¶çš„æ•°é‡ï¼Œä½†æ˜¯ä½ <br>
äº‹åä¸èƒ½æ”¹å˜åˆ†ç‰‡çš„æ•°é‡ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒElasticsearchä¸­çš„æ¯ä¸ªç´¢å¼•è¢«åˆ†ç‰‡5ä¸ªä¸»åˆ†ç‰‡å’Œ1ä¸ªå¤åˆ¶ï¼Œè¿™æ„å‘³ç€ï¼Œå¦‚æœä½ çš„é›†ç¾¤ä¸­è‡³å°‘æœ‰ä¸¤ä¸ªèŠ‚<br>
ç‚¹ï¼Œä½ çš„ç´¢å¼•å°†ä¼šæœ‰5ä¸ªä¸»åˆ†ç‰‡å’Œå¦å¤–5ä¸ªå¤åˆ¶åˆ†ç‰‡ï¼ˆ1ä¸ªå®Œå…¨æ‹·è´ï¼‰ï¼Œè¿™æ ·çš„è¯æ¯ä¸ªç´¢å¼•æ€»å…±å°±æœ‰10ä¸ªåˆ†ç‰‡ã€‚</p>
<h2 id="elasticsearchçš„å®¢æˆ·ç«¯æ“ä½œ">ElasticSearchçš„å®¢æˆ·ç«¯æ“ä½œ</h2>
<h3 id="ä¸‹è½½postman">ä¸‹è½½PostMan</h3>
<p>Postmanå®˜ç½‘ï¼šhttps://www.getpostman.com</p>
<h3 id="ä½¿ç”¨postmanå·¥å…·è¿›è¡Œrestfulæ¥å£è®¿é—®">ä½¿ç”¨Postmanå·¥å…·è¿›è¡ŒRestfulæ¥å£è®¿é—®</h3>
<h4 id="elasticsearchçš„æ¥å£è¯­æ³•">ElasticSearchçš„æ¥å£è¯­æ³•</h4>
<blockquote>
<p>curl â€X<VERB> '<PROTOCOL>ğŸ˜•/<HOST>:<PORT>/<PATH>?&lt;QUERY_STRING&gt;' â€d '<BODY>'</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center">å‚æ•°</th>
<th style="text-align:center">è§£é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">VERB</td>
<td style="text-align:center">é€‚å½“çš„ HTTP æ–¹æ³• æˆ– è°“è¯ : GET ã€ POST ã€ PUT ã€ HEAD æˆ–è€… DELETE</td>
</tr>
<tr>
<td style="text-align:center">PROTOCOL</td>
<td style="text-align:center">http æˆ–è€… https ï¼ˆå¦‚æœä½ åœ¨ Elasticsearch å‰é¢æœ‰ä¸€ä¸ª https ä»£ç†ï¼‰</td>
</tr>
<tr>
<td style="text-align:center">HOST</td>
<td style="text-align:center">Elasticsearch é›†ç¾¤ä¸­ä»»æ„èŠ‚ç‚¹çš„ä¸»æœºåï¼Œæˆ–è€…ç”¨ localhost ä»£è¡¨æœ¬åœ°æœºå™¨ä¸Šçš„èŠ‚ç‚¹</td>
</tr>
<tr>
<td style="text-align:center">PORT</td>
<td style="text-align:center">è¿è¡Œ Elasticsearch HTTP æœåŠ¡çš„ç«¯å£å·ï¼Œé»˜è®¤æ˜¯ 9200</td>
</tr>
<tr>
<td style="text-align:center">PATH</td>
<td style="text-align:center">API çš„ç»ˆç«¯è·¯å¾„ï¼ˆä¾‹å¦‚ _count å°†è¿”å›é›†ç¾¤ä¸­æ–‡æ¡£æ•°é‡ï¼‰ã€‚Path å¯èƒ½åŒ…å«å¤šä¸ªç»„ä»¶ï¼Œä¾‹å¦‚ï¼š _cluster/stats å’Œ _nodes/stats/jvm</td>
</tr>
<tr>
<td style="text-align:center">QUERY_STRING</td>
<td style="text-align:center">ä»»æ„å¯é€‰çš„æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•° (ä¾‹å¦‚ ?pretty å°†æ ¼å¼åŒ–åœ°è¾“å‡º JSON è¿”å›å€¼ï¼Œä½¿å…¶æ›´å®¹æ˜“é˜…è¯»)</td>
</tr>
<tr>
<td style="text-align:center">BODY</td>
<td style="text-align:center">ä¸€ä¸ª JSON æ ¼å¼çš„è¯·æ±‚ä½“ (å¦‚æœè¯·æ±‚éœ€è¦çš„è¯)</td>
</tr>
</tbody>
</table>
<h4 id="åˆ›å»ºç´¢å¼•indexå’Œæ˜ å°„mapping">åˆ›å»ºç´¢å¼•indexå’Œæ˜ å°„mapping</h4>
<pre><code class="language-url">curl  PUT   http://127.0.0.1:9200/blog1
</code></pre>
<p>body</p>
<pre><code class="language-json">{
    &quot;mappings&quot;: {
        &quot;article&quot;: {
            &quot;properties&quot;: {
                &quot;id&quot;: {
                 &quot;type&quot;: &quot;long&quot;,    
                    &quot;store&quot;: true,
                    &quot;index&quot;:&quot;not_analyzed&quot;
                },
                &quot;title&quot;: {
                 &quot;type&quot;: &quot;text&quot;,    
                    &quot;store&quot;: true,
                    &quot;index&quot;:&quot;analyzed&quot;,
                    &quot;analyzer&quot;:&quot;standard&quot;
                },
                &quot;content&quot;: {
                 &quot;type&quot;: &quot;text&quot;,    
                    &quot;store&quot;: true,
                    &quot;index&quot;:&quot;analyzed&quot;,
                    &quot;analyzer&quot;:&quot;standard&quot;
                }
            }
        }
    }
}
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;acknowledged&quot;: true,
    &quot;shards_acknowledged&quot;: true,
    &quot;index&quot;: &quot;blog1&quot;
}
</code></pre>
<h4 id="åˆ›å»ºç´¢å¼•åè®¾ç½®mapping">åˆ›å»ºç´¢å¼•åè®¾ç½®Mapping</h4>
<blockquote>
<p>å¯ä»¥åœ¨åˆ›å»ºç´¢å¼•æ—¶è®¾ç½®mappingä¿¡æ¯ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å…ˆåˆ›å»ºç´¢å¼•ç„¶åå†è®¾ç½®mappingã€‚<br>
åœ¨ä¸Šä¸€ä¸ªæ­¥éª¤ä¸­ä¸è®¾ç½®mapingä¿¡æ¯ï¼Œç›´æ¥ä½¿ç”¨putæ–¹æ³•åˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼Œç„¶åè®¾ç½®mappingä¿¡æ¯ã€‚</p>
</blockquote>
<pre><code class="language-url">curl  post  http://127.0.0.1:9200/blog2/hello/_mapping 
</code></pre>
<p>body</p>
<pre><code class="language-json">{
    &quot;hello&quot;: {
            &quot;properties&quot;: {
                &quot;id&quot;:{
                 &quot;type&quot;:&quot;long&quot;,    
                 &quot;store&quot;:true    
                },
                &quot;title&quot;:{
                 &quot;type&quot;:&quot;text&quot;,    
                 &quot;store&quot;:true,    
                 &quot;index&quot;:true,    
                 &quot;analyzer&quot;:&quot;standard&quot;    
                },
                &quot;content&quot;:{
                 &quot;type&quot;:&quot;text&quot;,
                 &quot;store&quot;:true,  
                 &quot;index&quot;:true,    
                 &quot;analyzer&quot;:&quot;standard&quot;    
                }
            }
        }
  }
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;acknowledged&quot;: true
}
</code></pre>
<h4 id="åˆ é™¤ç´¢å¼•index">åˆ é™¤ç´¢å¼•index</h4>
<pre><code class="language-curl">curl  delete  http://127.0.0.1:9200/blog1
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;acknowledged&quot;: true
}
</code></pre>
<h4 id="åˆ›å»ºæ–‡æ¡£document">åˆ›å»ºæ–‡æ¡£document</h4>
<pre><code class="language-curl">curl  post  http://127.0.0.1:9200/blog1/article/1
</code></pre>
<p>body</p>
<pre><code class="language-json">{
	&quot;id&quot;:1,    
	&quot;title&quot;:&quot;ElasticSearchæ˜¯ä¸€ä¸ªåŸºäºLuceneçš„æœç´¢æœåŠ¡å™¨&quot;,    
	&quot;content&quot;:&quot;å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäºRESTful webæ¥å£ã€‚Elasticsearchæ˜¯ç”¨Javaå¼€å‘çš„ï¼Œå¹¶ä½œä¸ºApacheè®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯å½“å‰æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚è®¾è®¡ç”¨äºäº‘è®¡ç®—ä¸­ï¼Œèƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿ã€‚&quot;
}
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;_index&quot;: &quot;blog1&quot;,
    &quot;_type&quot;: &quot;article&quot;,
    &quot;_id&quot;: &quot;1&quot;,
    &quot;_version&quot;: 1,
    &quot;result&quot;: &quot;created&quot;,
    &quot;_shards&quot;: {
        &quot;total&quot;: 2,
        &quot;successful&quot;: 1,
        &quot;failed&quot;: 0
    },
    &quot;created&quot;: true
}
</code></pre>
<h4 id="ä¿®æ”¹æ–‡æ¡£document">ä¿®æ”¹æ–‡æ¡£document</h4>
<pre><code class="language-curl">curl  post  http://127.0.0.1:9200/blog1/article/1 
</code></pre>
<p>body</p>
<pre><code class="language-json">{
	&quot;id&quot;:1,    
	&quot;title&quot;:&quot;[ä¿®æ”¹]ElasticSearchæ˜¯ä¸€ä¸ªåŸºäºLuceneçš„æœç´¢æœåŠ¡å™¨&quot;,    
	&quot;content&quot;:&quot;[ä¿®æ”¹]å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäºRESTful webæ¥å£ã€‚Elasticsearchæ˜¯ç”¨Javaå¼€å‘çš„ï¼Œå¹¶ä½œä¸ºApacheè®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯å½“å‰æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚è®¾è®¡ç”¨äºäº‘è®¡ç®—ä¸­ï¼Œèƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿ã€‚&quot;
}
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;_index&quot;: &quot;blog1&quot;,
    &quot;_type&quot;: &quot;article&quot;,
    &quot;_id&quot;: &quot;1&quot;,
    &quot;_version&quot;: 2,
    &quot;result&quot;: &quot;updated&quot;,
    &quot;_shards&quot;: {
        &quot;total&quot;: 2,
        &quot;successful&quot;: 1,
        &quot;failed&quot;: 0
    },
    &quot;created&quot;: false
}
</code></pre>
<h4 id="åˆ é™¤æ–‡æ¡£document">åˆ é™¤æ–‡æ¡£document</h4>
<pre><code class="language-curl">curl  delete  http://127.0.0.1:9200/blog1/article/1 
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;found&quot;: true,
    &quot;_index&quot;: &quot;blog1&quot;,
    &quot;_type&quot;: &quot;article&quot;,
    &quot;_id&quot;: &quot;1&quot;,
    &quot;_version&quot;: 3,
    &quot;result&quot;: &quot;deleted&quot;,
    &quot;_shards&quot;: {
        &quot;total&quot;: 2,
        &quot;successful&quot;: 1,
        &quot;failed&quot;: 0
    }
}
</code></pre>
<h4 id="æŸ¥è¯¢æ–‡æ¡£-æ ¹æ®idæŸ¥è¯¢">æŸ¥è¯¢æ–‡æ¡£-æ ¹æ®idæŸ¥è¯¢</h4>
<pre><code class="language-curl">curl  get  http://127.0.0.1:9200/blog1/article/1 
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;_index&quot;: &quot;blog1&quot;,
    &quot;_type&quot;: &quot;article&quot;,
    &quot;_id&quot;: &quot;1&quot;,
    &quot;_version&quot;: 1,
    &quot;found&quot;: true,
    &quot;_source&quot;: {
        &quot;id&quot;: 1,
        &quot;title&quot;: &quot;[ä¿®æ”¹]ElasticSearchæ˜¯ä¸€ä¸ªåŸºäºLuceneçš„æœç´¢æœåŠ¡å™¨&quot;,
        &quot;content&quot;: &quot;[ä¿®æ”¹]å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäºRESTful webæ¥å£ã€‚Elasticsearchæ˜¯ç”¨Javaå¼€å‘çš„ï¼Œå¹¶ä½œä¸ºApacheè®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯å½“å‰æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚è®¾è®¡ç”¨äºäº‘è®¡ç®—ä¸­ï¼Œèƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿ã€‚&quot;
    }
}
</code></pre>
<h4 id="æŸ¥è¯¢æ–‡æ¡£-querystringæŸ¥è¯¢">æŸ¥è¯¢æ–‡æ¡£-querystringæŸ¥è¯¢</h4>
<pre><code class="language-curl">curl  post  http://127.0.0.1:9200/blog1/article/_search
</code></pre>
<p>body</p>
<pre><code class="language-json">{
    &quot;query&quot;: {
        &quot;query_string&quot;: {
            &quot;default_field&quot;: &quot;title&quot;,
            &quot;query&quot;: &quot;æœç´¢æœåŠ¡å™¨&quot;
        }
    }
}
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;took&quot;: 24,
    &quot;timed_out&quot;: false,
    &quot;_shards&quot;: {
        &quot;total&quot;: 5,
        &quot;successful&quot;: 5,
        &quot;skipped&quot;: 0,
        &quot;failed&quot;: 0
    },
    &quot;hits&quot;: {
        &quot;total&quot;: 1,
        &quot;max_score&quot;: 1.4002227,
        &quot;hits&quot;: [
            {
                &quot;_index&quot;: &quot;blog1&quot;,
                &quot;_type&quot;: &quot;article&quot;,
                &quot;_id&quot;: &quot;1&quot;,
                &quot;_score&quot;: 1.4002227,
                &quot;_source&quot;: {
                    &quot;id&quot;: 1,
                    &quot;title&quot;: &quot;[ä¿®æ”¹]ElasticSearchæ˜¯ä¸€ä¸ªåŸºäºLuceneçš„æœç´¢æœåŠ¡å™¨&quot;,
                    &quot;content&quot;: &quot;[ä¿®æ”¹]å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäºRESTful webæ¥å£ã€‚Elasticsearchæ˜¯ç”¨Javaå¼€å‘çš„ï¼Œå¹¶ä½œä¸ºApacheè®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯å½“å‰æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚è®¾è®¡ç”¨äºäº‘è®¡ç®—ä¸­ï¼Œèƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿ã€‚&quot;
                }
            }
        ]
    }
}
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼šå°†æœç´¢å†…å®¹&quot;æœç´¢æœåŠ¡å™¨&quot;ä¿®æ”¹ä¸º&quot;é’¢ç´¢&quot;ï¼ŒåŒæ ·ä¹Ÿèƒ½æœç´¢åˆ°æ–‡æ¡£ï¼Œè¿™æ˜¯å› ä¸ºESæ˜¯æ­ªæœä»å¼€å‘çš„äº§å“ï¼Œæ‰€ä»¥å¯¹ä¸­æ–‡åˆ†è¯ä¸å‹å¥½ï¼Œéœ€è¦ä½¿ç”¨åˆ†è¯æ’ä»¶ï¼ˆIKåˆ†è¯å™¨ï¼‰æ¥è§£å†³ä¸­æ–‡åˆ†è¯é—®é¢˜</p>
</blockquote>
<h4 id="æŸ¥è¯¢æ–‡æ¡£-termæŸ¥è¯¢">æŸ¥è¯¢æ–‡æ¡£-termæŸ¥è¯¢</h4>
<pre><code class="language-curl">curl  post  http://127.0.0.1:9200/blog1/article/_search
</code></pre>
<p>body</p>
<pre><code class="language-json">{
    &quot;query&quot;: {
        &quot;term&quot;: {
            &quot;title&quot;: &quot;æœç´¢&quot;
        }
    }
}
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;took&quot;: 1,
    &quot;timed_out&quot;: false,
    &quot;_shards&quot;: {
        &quot;total&quot;: 5,
        &quot;successful&quot;: 5,
        &quot;skipped&quot;: 0,
        &quot;failed&quot;: 0
    },
    &quot;hits&quot;: {
        &quot;total&quot;: 0,
        &quot;max_score&quot;: null,
        &quot;hits&quot;: []
    }
}
</code></pre>
<h2 id="elasticsearché›†æˆik-åˆ†è¯å™¨">ElasticSearché›†æˆIK åˆ†è¯å™¨</h2>
<h3 id="ä¸Šè¿°æŸ¥è¯¢å­˜åœ¨é—®é¢˜åˆ†æ">ä¸Šè¿°æŸ¥è¯¢å­˜åœ¨é—®é¢˜åˆ†æ</h3>
<p>åœ¨è¿›è¡Œå­—ç¬¦ä¸²æŸ¥è¯¢æ—¶ï¼Œæˆ‘ä»¬å‘ç°å»æœç´¢&quot;æœç´¢æœåŠ¡å™¨&quot;å’Œ&quot;é’¢ç´¢&quot;éƒ½å¯ä»¥æœç´¢åˆ°æ•°æ®ï¼›</p>
<p>è€Œåœ¨è¿›è¡Œè¯æ¡æŸ¥è¯¢æ—¶ï¼Œæˆ‘ä»¬æœç´¢&quot;æœç´¢&quot;å´æ²¡æœ‰æœç´¢åˆ°æ•°æ®ï¼›</p>
<p>ç©¶å…¶åŸå› æ˜¯ElasticSearchçš„æ ‡å‡†åˆ†è¯å™¨å¯¼è‡´çš„ï¼Œå½“æˆ‘ä»¬åˆ›å»ºç´¢å¼•æ—¶ï¼Œå­—æ®µä½¿ç”¨çš„æ˜¯æ ‡å‡†åˆ†è¯å™¨ï¼š</p>
<pre><code class="language-json">&quot;analyzer&quot;:&quot;standard&quot; //æ ‡å‡†åˆ†è¯å™¨
</code></pre>
<p>ä¾‹å¦‚å¯¹ &quot;æˆ‘æ˜¯ç¨‹åºå‘˜&quot; è¿›è¡Œåˆ†è¯<br>
æ ‡å‡†åˆ†è¯å™¨åˆ†è¯æ•ˆæœæµ‹è¯•ï¼š</p>
<pre><code class="language-curl">curl  get  http://127.0.0.1:9200/_analyze?analyzer=standard&amp;pretty=true&amp;text=æˆ‘æ˜¯ç¨‹åºå‘˜
</code></pre>
<p>åˆ†è¯ç»“æœ</p>
<pre><code class="language-json">{
    &quot;tokens&quot;: [
        {
            &quot;token&quot;: &quot;æˆ‘&quot;,
            &quot;start_offset&quot;: 0,
            &quot;end_offset&quot;: 1,
            &quot;type&quot;: &quot;&lt;IDEOGRAPHIC&gt;&quot;,
            &quot;position&quot;: 0
        },
        {
            &quot;token&quot;: &quot;æ˜¯&quot;,
            &quot;start_offset&quot;: 1,
            &quot;end_offset&quot;: 2,
            &quot;type&quot;: &quot;&lt;IDEOGRAPHIC&gt;&quot;,
            &quot;position&quot;: 1
        },
        {
            &quot;token&quot;: &quot;ç¨‹&quot;,
            &quot;start_offset&quot;: 2,
            &quot;end_offset&quot;: 3,
            &quot;type&quot;: &quot;&lt;IDEOGRAPHIC&gt;&quot;,
            &quot;position&quot;: 2
        },
        {
            &quot;token&quot;: &quot;åº&quot;,
            &quot;start_offset&quot;: 3,
            &quot;end_offset&quot;: 4,
            &quot;type&quot;: &quot;&lt;IDEOGRAPHIC&gt;&quot;,
            &quot;position&quot;: 3
        },
        {
            &quot;token&quot;: &quot;å‘˜&quot;,
            &quot;start_offset&quot;: 4,
            &quot;end_offset&quot;: 5,
            &quot;type&quot;: &quot;&lt;IDEOGRAPHIC&gt;&quot;,
            &quot;position&quot;: 4
        }
    ]
}
</code></pre>
<p>è€Œæˆ‘ä»¬éœ€è¦çš„åˆ†è¯æ•ˆæœæ˜¯ï¼šæˆ‘ã€æ˜¯ã€ç¨‹åºã€ç¨‹åºå‘˜</p>
<p>è¿™æ ·çš„è¯å°±éœ€è¦å¯¹ä¸­æ–‡æ”¯æŒè‰¯å¥½çš„åˆ†æå™¨çš„æ”¯æŒï¼Œæ”¯æŒä¸­æ–‡åˆ†è¯çš„åˆ†è¯å™¨æœ‰å¾ˆå¤šï¼Œwordåˆ†è¯å™¨ã€åº–ä¸è§£ç‰›ã€ç›˜å¤<br>
åˆ†è¯ã€Ansjåˆ†è¯ç­‰ï¼Œä½†æˆ‘ä»¬å¸¸ç”¨çš„è¿˜æ˜¯ä¸‹é¢è¦ä»‹ç»çš„IKåˆ†è¯å™¨ã€‚</p>
<h3 id="ikåˆ†è¯å™¨ç®€ä»‹">IKåˆ†è¯å™¨ç®€ä»‹</h3>
<p>IKAnalyzeræ˜¯ä¸€ä¸ªå¼€æºçš„ï¼ŒåŸºäºjavaè¯­è¨€å¼€å‘çš„è½»é‡çº§çš„ä¸­æ–‡åˆ†è¯å·¥å…·åŒ…ã€‚ä»2006å¹´12æœˆæ¨å‡º1.0ç‰ˆå¼€å§‹ï¼Œ<br>
IKAnalyzerå·²ç»æ¨å‡º äº†3ä¸ªå¤§ç‰ˆæœ¬ã€‚æœ€åˆï¼Œå®ƒæ˜¯ä»¥å¼€æºé¡¹ç›®Luceneä¸ºåº”ç”¨ä¸»ä½“çš„ï¼Œç»“åˆè¯å…¸åˆ†è¯å’Œæ–‡æ³•åˆ†æç®—æ³•çš„<br>
ä¸­æ–‡åˆ†è¯ç»„ä»¶ã€‚æ–°ç‰ˆæœ¬çš„IKAnalyzer3.0åˆ™å‘å±•ä¸º é¢å‘Javaçš„å…¬ç”¨åˆ†è¯ç»„ä»¶ï¼Œç‹¬ç«‹äºLuceneé¡¹ç›®ï¼ŒåŒæ—¶æä¾›äº†å¯¹<br>
Luceneçš„é»˜è®¤ä¼˜åŒ–å®ç°ã€‚</p>
<p>IKåˆ†è¯å™¨3.0çš„ç‰¹æ€§å¦‚ä¸‹ï¼š</p>
<ol>
<li>é‡‡ç”¨äº†ç‰¹æœ‰çš„â€œæ­£å‘è¿­ä»£æœ€ç»†ç²’åº¦åˆ‡åˆ†ç®—æ³•â€œï¼Œå…·æœ‰60ä¸‡å­—/ç§’çš„é«˜é€Ÿå¤„ç†èƒ½åŠ›ã€‚</li>
<li>é‡‡ç”¨äº†å¤šå­å¤„ç†å™¨åˆ†ææ¨¡å¼ï¼Œæ”¯æŒï¼šè‹±æ–‡å­—æ¯ï¼ˆIPåœ°å€ã€Emailã€URLï¼‰ã€æ•°å­—ï¼ˆæ—¥æœŸï¼Œå¸¸ç”¨ä¸­æ–‡æ•°é‡è¯ï¼Œç½—é©¬æ•°å­—ï¼Œç§‘å­¦è®¡æ•°æ³•ï¼‰ï¼Œä¸­æ–‡è¯æ±‡ï¼ˆå§“åã€åœ°åå¤„ç†ï¼‰ç­‰åˆ†è¯å¤„ç†ã€‚</li>
<li>å¯¹ä¸­è‹±è”åˆæ”¯æŒä¸æ˜¯å¾ˆå¥½,åœ¨è¿™æ–¹é¢çš„å¤„ç†æ¯”è¾ƒéº»çƒ¦.éœ€å†åšä¸€æ¬¡æŸ¥è¯¢,åŒ<br>
æ—¶æ˜¯æ”¯æŒä¸ªäººè¯æ¡çš„ä¼˜åŒ–çš„è¯å…¸å­˜å‚¨ï¼Œæ›´å°çš„å†…å­˜å ç”¨ã€‚</li>
<li>æ”¯æŒç”¨æˆ·è¯å…¸æ‰©å±•å®šä¹‰ã€‚</li>
<li>é’ˆå¯¹Luceneå…¨æ–‡æ£€ç´¢ä¼˜åŒ–çš„æŸ¥è¯¢åˆ†æå™¨IKQueryParserï¼›é‡‡ç”¨æ­§ä¹‰åˆ†æç®—æ³•ä¼˜åŒ–æŸ¥è¯¢å…³é”®å­—çš„æœç´¢æ’åˆ—ç»„åˆï¼Œèƒ½æå¤§çš„æé«˜Luceneæ£€ç´¢çš„å‘½ä¸­ç‡ã€‚</li>
</ol>
<h3 id="elasticsearché›†æˆikåˆ†è¯å™¨">ElasticSearché›†æˆIKåˆ†è¯å™¨</h3>
<h4 id="ikåˆ†è¯å™¨çš„å®‰è£…">IKåˆ†è¯å™¨çš„å®‰è£…</h4>
<p>1ã€ä¸‹è½½åœ°å€ï¼šhttps://github.com/medcl/elasticsearch-analysis-ik/releases</p>
<p>2ã€è§£å‹ï¼Œå°†è§£å‹åçš„elasticsearchæ–‡ä»¶å¤¹æ‹·è´åˆ°elasticsearch-5.6.8\pluginsä¸‹ï¼Œå¹¶é‡å‘½åæ–‡ä»¶å¤¹ä¸ºanalysis-ik</p>
<p>3ã€é‡æ–°å¯åŠ¨ElasticSearchï¼Œå³å¯åŠ è½½IKåˆ†è¯å™¨</p>
<h4 id="ikåˆ†è¯å™¨æµ‹è¯•">IKåˆ†è¯å™¨æµ‹è¯•</h4>
<p>IKæä¾›äº†ä¸¤ä¸ªåˆ†è¯ç®—æ³•ik_smart å’Œ ik_max_word</p>
<p>å…¶ä¸­ ik_smart ä¸ºæœ€å°‘åˆ‡åˆ†ï¼Œik_max_wordä¸ºæœ€ç»†ç²’åº¦åˆ’åˆ†</p>
<h5 id="1-æœ€å°åˆ‡åˆ†">1ã€æœ€å°åˆ‡åˆ†</h5>
<pre><code class="language-curl">curl  get  http://127.0.0.1:9200/_analyze?analyzer=ik_smart&amp;pretty=true&amp;text=æˆ‘æ˜¯ç¨‹åºå‘˜
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;tokens&quot;: [
        {
            &quot;token&quot;: &quot;æˆ‘&quot;,
            &quot;start_offset&quot;: 0,
            &quot;end_offset&quot;: 1,
            &quot;type&quot;: &quot;CN_CHAR&quot;,
            &quot;position&quot;: 0
        },
        {
            &quot;token&quot;: &quot;æ˜¯&quot;,
            &quot;start_offset&quot;: 1,
            &quot;end_offset&quot;: 2,
            &quot;type&quot;: &quot;CN_CHAR&quot;,
            &quot;position&quot;: 1
        },
        {
            &quot;token&quot;: &quot;ç¨‹åºå‘˜&quot;,
            &quot;start_offset&quot;: 2,
            &quot;end_offset&quot;: 5,
            &quot;type&quot;: &quot;CN_WORD&quot;,
            &quot;position&quot;: 2
        }
    ]
}
</code></pre>
<h5 id="2-æœ€ç»†åˆ‡åˆ†">2ã€æœ€ç»†åˆ‡åˆ†</h5>
<pre><code class="language-curl">curl  get  http://127.0.0.1:9200/_analyze?analyzer=ik_max_word&amp;pretty=true&amp;text=æˆ‘æ˜¯ç¨‹åºå‘˜
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;tokens&quot;: [
        {
            &quot;token&quot;: &quot;æˆ‘&quot;,
            &quot;start_offset&quot;: 0,
            &quot;end_offset&quot;: 1,
            &quot;type&quot;: &quot;CN_CHAR&quot;,
            &quot;position&quot;: 0
        },
        {
            &quot;token&quot;: &quot;æ˜¯&quot;,
            &quot;start_offset&quot;: 1,
            &quot;end_offset&quot;: 2,
            &quot;type&quot;: &quot;CN_CHAR&quot;,
            &quot;position&quot;: 1
        },
        {
            &quot;token&quot;: &quot;ç¨‹åºå‘˜&quot;,
            &quot;start_offset&quot;: 2,
            &quot;end_offset&quot;: 5,
            &quot;type&quot;: &quot;CN_WORD&quot;,
            &quot;position&quot;: 2
        },
        {
            &quot;token&quot;: &quot;ç¨‹åº&quot;,
            &quot;start_offset&quot;: 2,
            &quot;end_offset&quot;: 4,
            &quot;type&quot;: &quot;CN_WORD&quot;,
            &quot;position&quot;: 3
        },
        {
            &quot;token&quot;: &quot;å‘˜&quot;,
            &quot;start_offset&quot;: 4,
            &quot;end_offset&quot;: 5,
            &quot;type&quot;: &quot;CN_CHAR&quot;,
            &quot;position&quot;: 4
        }
    ]
}
</code></pre>
<h3 id="ä¿®æ”¹ç´¢å¼•æ˜ å°„mapping">ä¿®æ”¹ç´¢å¼•æ˜ å°„mapping</h3>
<h4 id="é‡å»ºç´¢å¼•">é‡å»ºç´¢å¼•</h4>
<p>åˆ é™¤åŸæœ‰blog1ç´¢å¼•</p>
<pre><code class="language-curl">curl  delete  http://127.0.0.1:9200/blog1
</code></pre>
<p>åˆ›å»ºblog1ç´¢å¼•ï¼Œæ­¤æ—¶åˆ†è¯å™¨ä½¿ç”¨ik_max_word</p>
<pre><code class="language-curl">curl  put  http://127.0.0.1:9200/blog1
</code></pre>
<p>body</p>
<pre><code class="language-json">{
    &quot;mappings&quot;: {
        &quot;article&quot;: {
            &quot;properties&quot;: {
                &quot;id&quot;: {
                 &quot;type&quot;: &quot;long&quot;,    
                    &quot;store&quot;: true,
                    &quot;index&quot;:&quot;not_analyzed&quot;
                },
                &quot;title&quot;: {
                 &quot;type&quot;: &quot;text&quot;,    
                    &quot;store&quot;: true,
                    &quot;index&quot;:&quot;analyzed&quot;,
                    &quot;analyzer&quot;:&quot;ik_max_word&quot;
                },
                &quot;content&quot;: {
                 &quot;type&quot;: &quot;text&quot;,    
                    &quot;store&quot;: true,
                    &quot;index&quot;:&quot;analyzed&quot;,
                    &quot;analyzer&quot;:&quot;ik_max_word&quot;
                }
            }
        }
    }
}
</code></pre>
<h4 id="åˆ›å»ºæ–‡æ¡£">åˆ›å»ºæ–‡æ¡£</h4>
<pre><code class="language-curl">curl  post http://127.0.0.1:9200/blog1/article/1
</code></pre>
<p>body</p>
<pre><code class="language-json">{
	&quot;id&quot;:1,    
	&quot;title&quot;:&quot;ElasticSearchæ˜¯ä¸€ä¸ªåŸºäºLuceneçš„æœç´¢æœåŠ¡å™¨&quot;,    
	&quot;content&quot;:&quot;å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäºRESTful webæ¥å£ã€‚Elasticsearchæ˜¯ç”¨Javaå¼€å‘çš„ï¼Œå¹¶ä½œä¸ºApacheè®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯å½“å‰æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚è®¾è®¡ç”¨äºäº‘è®¡ç®—ä¸­ï¼Œèƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿ã€‚&quot;
}
</code></pre>
<h4 id="æµ‹è¯•querystringæŸ¥è¯¢">æµ‹è¯•queryStringæŸ¥è¯¢</h4>
<pre><code class="language-curl">curl  post http://127.0.0.1:9200/blog1/article/_search
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;took&quot;: 101,
    &quot;timed_out&quot;: false,
    &quot;_shards&quot;: {
        &quot;total&quot;: 5,
        &quot;successful&quot;: 5,
        &quot;skipped&quot;: 0,
        &quot;failed&quot;: 0
    },
    &quot;hits&quot;: {
        &quot;total&quot;: 1,
        &quot;max_score&quot;: 1.012641,
        &quot;hits&quot;: [
            {
                &quot;_index&quot;: &quot;blog1&quot;,
                &quot;_type&quot;: &quot;article&quot;,
                &quot;_id&quot;: &quot;1&quot;,
                &quot;_score&quot;: 1.012641,
                &quot;_source&quot;: {
                    &quot;id&quot;: 1,
                    &quot;title&quot;: &quot;ElasticSearchæ˜¯ä¸€ä¸ªåŸºäºLuceneçš„æœç´¢æœåŠ¡å™¨&quot;,
                    &quot;content&quot;: &quot;å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäºRESTful webæ¥å£ã€‚Elasticsearchæ˜¯ç”¨Javaå¼€å‘çš„ï¼Œå¹¶ä½œä¸ºApacheè®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯å½“å‰æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚è®¾è®¡ç”¨äºäº‘è®¡ç®—ä¸­ï¼Œèƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿ã€‚&quot;
                }
            }
        ]
    }
}
</code></pre>
<blockquote>
<p>è¿™æ¬¡å†æ¬¡æµ‹è¯•é’¢ç´¢åˆ™æ— æ³•æœç´¢åˆ°å†…å®¹</p>
</blockquote>
<h4 id="termæµ‹è¯•">termæµ‹è¯•</h4>
<pre><code class="language-curl">curl  post http://127.0.0.1:9200/blog1/article/_search
</code></pre>
<p>body</p>
<pre><code class="language-json">{
    &quot;query&quot;: {
        &quot;term&quot;: {
            &quot;title&quot;: &quot;æœç´¢&quot;
        }
    }
}
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;took&quot;: 5,
    &quot;timed_out&quot;: false,
    &quot;_shards&quot;: {
        &quot;total&quot;: 5,
        &quot;successful&quot;: 5,
        &quot;skipped&quot;: 0,
        &quot;failed&quot;: 0
    },
    &quot;hits&quot;: {
        &quot;total&quot;: 1,
        &quot;max_score&quot;: 0.25316024,
        &quot;hits&quot;: [
            {
                &quot;_index&quot;: &quot;blog1&quot;,
                &quot;_type&quot;: &quot;article&quot;,
                &quot;_id&quot;: &quot;1&quot;,
                &quot;_score&quot;: 0.25316024,
                &quot;_source&quot;: {
                    &quot;id&quot;: 1,
                    &quot;title&quot;: &quot;ElasticSearchæ˜¯ä¸€ä¸ªåŸºäºLuceneçš„æœç´¢æœåŠ¡å™¨&quot;,
                    &quot;content&quot;: &quot;å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäºRESTful webæ¥å£ã€‚Elasticsearchæ˜¯ç”¨Javaå¼€å‘çš„ï¼Œå¹¶ä½œä¸ºApacheè®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯å½“å‰æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚è®¾è®¡ç”¨äºäº‘è®¡ç®—ä¸­ï¼Œèƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿ã€‚&quot;
                }
            }
        ]
    }
}
</code></pre>
<h2 id="elasticsearché›†ç¾¤">ElasticSearché›†ç¾¤</h2>
<p>ESé›†ç¾¤æ˜¯ä¸€ä¸ª P2Pç±»å‹(ä½¿ç”¨ gossip åè®®)çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œé™¤äº†é›†ç¾¤çŠ¶æ€ç®¡ç†ä»¥å¤–ï¼Œå…¶ä»–æ‰€æœ‰çš„è¯·æ±‚éƒ½å¯ä»¥å‘é€åˆ°<br>
é›†ç¾¤å†…ä»»æ„ä¸€å°èŠ‚ç‚¹ä¸Šï¼Œè¿™ä¸ªèŠ‚ç‚¹å¯ä»¥è‡ªå·±æ‰¾åˆ°éœ€è¦è½¬å‘ç»™å“ªäº›èŠ‚ç‚¹ï¼Œå¹¶ä¸”ç›´æ¥è·Ÿè¿™äº›èŠ‚ç‚¹é€šä¿¡ã€‚æ‰€ä»¥ï¼Œä»ç½‘ç»œæ¶<br>
æ„åŠæœåŠ¡é…ç½®ä¸Šæ¥è¯´ï¼Œæ„å»ºé›†ç¾¤æ‰€éœ€è¦çš„é…ç½®æå…¶ç®€å•ã€‚åœ¨ Elasticsearch 2.0 ä¹‹å‰ï¼Œæ— é˜»ç¢çš„ç½‘ç»œä¸‹ï¼Œæ‰€æœ‰é…ç½®äº†<br>
ç›¸åŒ cluster.name çš„èŠ‚ç‚¹éƒ½è‡ªåŠ¨å½’å±åˆ°ä¸€ä¸ªé›†ç¾¤ä¸­ã€‚2.0 ç‰ˆæœ¬ä¹‹åï¼ŒåŸºäºå®‰å…¨çš„è€ƒè™‘é¿å…å¼€å‘ç¯å¢ƒè¿‡äºéšä¾¿é€ æˆçš„<br>
éº»çƒ¦ï¼Œä» 2.0 ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤çš„è‡ªåŠ¨å‘ç°æ–¹å¼æ”¹ä¸ºäº†å•æ’­(unicast)æ–¹å¼ã€‚é…ç½®é‡Œæä¾›å‡ å°èŠ‚ç‚¹çš„åœ°å€ï¼ŒES å°†å…¶è§†ä½œ<br>
gossip router è§’è‰²ï¼Œå€Ÿä»¥å®Œæˆé›†ç¾¤çš„å‘ç°ã€‚ç”±äºè¿™åªæ˜¯ ES å†…ä¸€ä¸ªå¾ˆå°çš„åŠŸèƒ½ï¼Œæ‰€ä»¥ gossip router è§’è‰²å¹¶ä¸éœ€è¦<br>
å•ç‹¬é…ç½®ï¼Œæ¯ä¸ª ES èŠ‚ç‚¹éƒ½å¯ä»¥æ‹…ä»»ã€‚æ‰€ä»¥ï¼Œé‡‡ç”¨å•æ’­æ–¹å¼çš„é›†ç¾¤ï¼Œå„èŠ‚ç‚¹éƒ½é…ç½®ç›¸åŒçš„å‡ ä¸ªèŠ‚ç‚¹åˆ—è¡¨ä½œä¸º router<br>
å³å¯ã€‚</p>
<p>é›†ç¾¤ä¸­èŠ‚ç‚¹æ•°é‡æ²¡æœ‰é™åˆ¶ï¼Œä¸€èˆ¬å¤§äºç­‰äº2ä¸ªèŠ‚ç‚¹å°±å¯ä»¥çœ‹åšæ˜¯é›†ç¾¤äº†ã€‚ä¸€èˆ¬å¤„äºé«˜æ€§èƒ½åŠé«˜å¯ç”¨æ–¹é¢æ¥è€ƒè™‘ä¸€èˆ¬<br>
é›†ç¾¤ä¸­çš„èŠ‚ç‚¹æ•°é‡éƒ½æ˜¯3ä¸ªåŠ3ä¸ªä»¥ä¸Šã€‚</p>
<h3 id="é›†ç¾¤çš„ç›¸å…³æ¦‚å¿µ">é›†ç¾¤çš„ç›¸å…³æ¦‚å¿µ</h3>
<h4 id="é›†ç¾¤-cluster-2">é›†ç¾¤ cluster</h4>
<p>ä¸€ä¸ªé›†ç¾¤å°±æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹ç»„ç»‡åœ¨ä¸€èµ·ï¼Œå®ƒä»¬å…±åŒæŒæœ‰æ•´ä¸ªçš„æ•°æ®ï¼Œå¹¶ä¸€èµ·æä¾›ç´¢å¼•å’Œæœç´¢åŠŸèƒ½ã€‚ä¸€ä¸ªé›†ç¾¤ç”±<br>
ä¸€ä¸ªå”¯ä¸€çš„åå­—æ ‡è¯†ï¼Œè¿™ä¸ªåå­—é»˜è®¤å°±æ˜¯â€œelasticsearchâ€ã€‚è¿™ä¸ªåå­—æ˜¯é‡è¦çš„ï¼Œå› ä¸ºä¸€ä¸ªèŠ‚ç‚¹åªèƒ½é€šè¿‡æŒ‡å®šæŸä¸ªé›†<br>
ç¾¤çš„åå­—ï¼Œæ¥åŠ å…¥è¿™ä¸ªé›†ç¾¤</p>
<h4 id="èŠ‚ç‚¹-node-2">èŠ‚ç‚¹ node</h4>
<p>ä¸€ä¸ªèŠ‚ç‚¹æ˜¯é›†ç¾¤ä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä½œä¸ºé›†ç¾¤çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå­˜å‚¨æ•°æ®ï¼Œå‚ä¸é›†ç¾¤çš„ç´¢å¼•å’Œæœç´¢åŠŸèƒ½ã€‚å’Œé›†ç¾¤ç±»ä¼¼ï¼Œä¸€<br>
ä¸ªèŠ‚ç‚¹ä¹Ÿæ˜¯ç”±ä¸€ä¸ªåå­—æ¥æ ‡è¯†çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªåå­—æ˜¯ä¸€ä¸ªéšæœºçš„æ¼«å¨æ¼«ç”»è§’è‰²çš„åå­—ï¼Œè¿™ä¸ªåå­—ä¼šåœ¨å¯åŠ¨çš„<br>
æ—¶å€™èµ‹äºˆèŠ‚ç‚¹ã€‚è¿™ä¸ªåå­—å¯¹äºç®¡ç†å·¥ä½œæ¥è¯´æŒºé‡è¦çš„ï¼Œå› ä¸ºåœ¨è¿™ä¸ªç®¡ç†è¿‡ç¨‹ä¸­ï¼Œä½ ä¼šå»ç¡®å®šç½‘ç»œä¸­çš„å“ªäº›æœåŠ¡å™¨å¯¹<br>
åº”äºElasticsearché›†ç¾¤ä¸­çš„å“ªäº›èŠ‚ç‚¹ã€‚</p>
<p>ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥é€šè¿‡é…ç½®é›†ç¾¤åç§°çš„æ–¹å¼æ¥åŠ å…¥ä¸€ä¸ªæŒ‡å®šçš„é›†ç¾¤ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šè¢«å®‰æ’åŠ å…¥åˆ°ä¸€ä¸ªå«<br>
åšâ€œelasticsearchâ€çš„é›†ç¾¤ä¸­ï¼Œè¿™æ„å‘³ç€ï¼Œå¦‚æœä½ åœ¨ä½ çš„ç½‘ç»œä¸­å¯åŠ¨äº†è‹¥å¹²ä¸ªèŠ‚ç‚¹ï¼Œå¹¶å‡å®šå®ƒä»¬èƒ½å¤Ÿç›¸äº’å‘ç°å½¼æ­¤ï¼Œ<br>
å®ƒä»¬å°†ä¼šè‡ªåŠ¨åœ°å½¢æˆå¹¶åŠ å…¥åˆ°ä¸€ä¸ªå«åšâ€œelasticsearchâ€çš„é›†ç¾¤ä¸­ã€‚</p>
<p>åœ¨ä¸€ä¸ªé›†ç¾¤é‡Œï¼Œåªè¦ä½ æƒ³ï¼Œå¯ä»¥æ‹¥æœ‰ä»»æ„å¤šä¸ªèŠ‚ç‚¹ã€‚è€Œä¸”ï¼Œå¦‚æœå½“å‰ä½ çš„ç½‘ç»œä¸­æ²¡æœ‰è¿è¡Œä»»ä½•ElasticsearchèŠ‚ç‚¹ï¼Œ<br>
è¿™æ—¶å¯åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¼šé»˜è®¤åˆ›å»ºå¹¶åŠ å…¥ä¸€ä¸ªå«åšâ€œelasticsearchâ€çš„é›†ç¾¤ã€‚</p>
<h4 id="åˆ†ç‰‡å’Œå¤åˆ¶-shardsreplicas-2">åˆ†ç‰‡å’Œå¤åˆ¶ shards&amp;replicas</h4>
<p>ä¸€ä¸ªç´¢å¼•å¯ä»¥å­˜å‚¨è¶…å‡ºå•ä¸ªç»“ç‚¹ç¡¬ä»¶é™åˆ¶çš„å¤§é‡æ•°æ®ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªå…·æœ‰10äº¿æ–‡æ¡£çš„ç´¢å¼•å æ®1TBçš„ç£ç›˜ç©ºé—´ï¼Œè€Œä»»<br>
ä¸€èŠ‚ç‚¹éƒ½æ²¡æœ‰è¿™æ ·å¤§çš„ç£ç›˜ç©ºé—´ï¼›æˆ–è€…å•ä¸ªèŠ‚ç‚¹å¤„ç†æœç´¢è¯·æ±‚ï¼Œå“åº”å¤ªæ…¢ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒElasticsearchæä¾›<br>
äº†å°†ç´¢å¼•åˆ’åˆ†æˆå¤šä»½çš„èƒ½åŠ›ï¼Œè¿™äº›ä»½å°±å«åšåˆ†ç‰‡ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œä½ å¯ä»¥æŒ‡å®šä½ æƒ³è¦çš„åˆ†ç‰‡çš„æ•°é‡ã€‚æ¯<br>
ä¸ªåˆ†ç‰‡æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„å¹¶ä¸”ç‹¬ç«‹çš„â€œç´¢å¼•â€ï¼Œè¿™ä¸ªâ€œç´¢å¼•â€å¯ä»¥è¢«æ”¾ç½®åˆ°é›†ç¾¤ä¸­çš„ä»»ä½•èŠ‚ç‚¹ä¸Šã€‚åˆ†ç‰‡å¾ˆé‡è¦ï¼Œä¸»<br>
è¦æœ‰ä¸¤æ–¹é¢çš„åŸå› ï¼š 1ï¼‰å…è®¸ä½ æ°´å¹³åˆ†å‰²/æ‰©å±•ä½ çš„å†…å®¹å®¹é‡ã€‚ 2ï¼‰å…è®¸ä½ åœ¨åˆ†ç‰‡ï¼ˆæ½œåœ¨åœ°ï¼Œä½äºå¤šä¸ªèŠ‚ç‚¹ä¸Šï¼‰ä¹‹ä¸Šè¿›è¡Œåˆ†å¸ƒå¼çš„ã€å¹¶è¡Œçš„æ“ä½œï¼Œè¿›è€Œæé«˜æ€§èƒ½/ååé‡ã€‚</p>
<p>è‡³äºä¸€ä¸ªåˆ†ç‰‡æ€æ ·åˆ†å¸ƒï¼Œå®ƒçš„æ–‡æ¡£æ€æ ·èšåˆå›æœç´¢è¯·æ±‚ï¼Œæ˜¯å®Œå…¨ç”±Elasticsearchç®¡ç†çš„ï¼Œå¯¹äºä½œä¸ºç”¨æˆ·çš„ä½ æ¥è¯´ï¼Œ<br>
è¿™äº›éƒ½æ˜¯é€æ˜çš„ã€‚</p>
<p>åœ¨ä¸€ä¸ªç½‘ç»œ/äº‘çš„ç¯å¢ƒé‡Œï¼Œå¤±è´¥éšæ—¶éƒ½å¯èƒ½å‘ç”Ÿï¼Œåœ¨æŸä¸ªåˆ†ç‰‡/èŠ‚ç‚¹ä¸çŸ¥æ€ä¹ˆçš„å°±å¤„äºç¦»çº¿çŠ¶æ€ï¼Œæˆ–è€…ç”±äºä»»ä½•åŸå› <br>
æ¶ˆå¤±äº†ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæœ‰ä¸€ä¸ªæ•…éšœè½¬ç§»æœºåˆ¶æ˜¯éå¸¸æœ‰ç”¨å¹¶ä¸”æ˜¯å¼ºçƒˆæ¨èçš„ã€‚ä¸ºæ­¤ç›®çš„ï¼ŒElasticsearchå…è®¸ä½ åˆ›å»ºåˆ†<br>
ç‰‡çš„ä¸€ä»½æˆ–å¤šä»½æ‹·è´ï¼Œè¿™äº›æ‹·è´å«åšå¤åˆ¶åˆ†ç‰‡ï¼Œæˆ–è€…ç›´æ¥å«å¤åˆ¶ã€‚</p>
<p>å¤åˆ¶ä¹‹æ‰€ä»¥é‡è¦ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦åŸå› ï¼š åœ¨åˆ†ç‰‡/èŠ‚ç‚¹å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œæä¾›äº†é«˜å¯ç”¨æ€§ã€‚å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæ³¨æ„åˆ°å¤åˆ¶åˆ†<br>
ç‰‡ä»ä¸ä¸åŸ/ä¸»è¦ï¼ˆoriginal/primaryï¼‰åˆ†ç‰‡ç½®äºåŒä¸€èŠ‚ç‚¹ä¸Šæ˜¯éå¸¸é‡è¦çš„ã€‚æ‰©å±•ä½ çš„æœç´¢é‡/ååé‡ï¼Œå› ä¸ºæœç´¢å¯ä»¥<br>
åœ¨æ‰€æœ‰çš„å¤åˆ¶ä¸Šå¹¶è¡Œè¿è¡Œã€‚æ€»ä¹‹ï¼Œæ¯ä¸ªç´¢å¼•å¯ä»¥è¢«åˆ†æˆå¤šä¸ªåˆ†ç‰‡ã€‚ä¸€ä¸ªç´¢å¼•ä¹Ÿå¯ä»¥è¢«å¤åˆ¶0æ¬¡ï¼ˆæ„æ€æ˜¯æ²¡æœ‰å¤åˆ¶ï¼‰<br>
æˆ–å¤šæ¬¡ã€‚ä¸€æ—¦å¤åˆ¶äº†ï¼Œæ¯ä¸ªç´¢å¼•å°±æœ‰äº†ä¸»åˆ†ç‰‡ï¼ˆä½œä¸ºå¤åˆ¶æºçš„åŸæ¥çš„åˆ†ç‰‡ï¼‰å’Œå¤åˆ¶åˆ†ç‰‡ï¼ˆä¸»åˆ†ç‰‡çš„æ‹·è´ï¼‰ä¹‹åˆ«ã€‚åˆ†<br>
ç‰‡å’Œå¤åˆ¶çš„æ•°é‡å¯ä»¥åœ¨ç´¢å¼•åˆ›å»ºçš„æ—¶å€™æŒ‡å®šã€‚åœ¨ç´¢å¼•åˆ›å»ºä¹‹åï¼Œä½ å¯ä»¥åœ¨ä»»ä½•æ—¶å€™åŠ¨æ€åœ°æ”¹å˜å¤åˆ¶çš„æ•°é‡ï¼Œä½†æ˜¯ä½ <br>
äº‹åä¸èƒ½æ”¹å˜åˆ†ç‰‡çš„æ•°é‡ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒElasticsearchä¸­çš„æ¯ä¸ªç´¢å¼•è¢«åˆ†ç‰‡5ä¸ªä¸»åˆ†ç‰‡å’Œ1ä¸ªå¤åˆ¶ï¼Œè¿™æ„å‘³ç€ï¼Œå¦‚æœä½ çš„é›†ç¾¤ä¸­è‡³å°‘æœ‰ä¸¤ä¸ªèŠ‚<br>
ç‚¹ï¼Œä½ çš„ç´¢å¼•å°†ä¼šæœ‰5ä¸ªä¸»åˆ†ç‰‡å’Œå¦å¤–5ä¸ªå¤åˆ¶åˆ†ç‰‡ï¼ˆ1ä¸ªå®Œå…¨æ‹·è´ï¼‰ï¼Œè¿™æ ·çš„è¯æ¯ä¸ªç´¢å¼•æ€»å…±å°±æœ‰10ä¸ªåˆ†ç‰‡ã€‚</p>
<h3 id="é›†ç¾¤çš„æ­å»º">é›†ç¾¤çš„æ­å»º</h3>
<h4 id="å‡†å¤‡ä¸‰å°elasticsearchæœåŠ¡å™¨">å‡†å¤‡ä¸‰å°elasticsearchæœåŠ¡å™¨</h4>
<p>åˆ›å»ºelasticsearch-clusteræ–‡ä»¶å¤¹ï¼Œåœ¨å†…éƒ¨å¤åˆ¶ä¸‰ä¸ªelasticsearchæœåŠ¡</p>
<h4 id="ä¿®æ”¹æ¯å°æœåŠ¡å™¨é…ç½®">ä¿®æ”¹æ¯å°æœåŠ¡å™¨é…ç½®</h4>
<p>ä¿®æ”¹elasticsearch-cluster\node*\config\elasticsearch.ymlé…ç½®æ–‡ä»¶</p>
<h5 id="node1èŠ‚ç‚¹">node1èŠ‚ç‚¹ï¼š</h5>
<pre><code class="language-yaml">#èŠ‚ç‚¹3çš„é…ç½®ä¿¡æ¯ï¼š
#é›†ç¾¤åç§°ï¼Œä¿è¯å”¯ä¸€
cluster.name: my-elasticsearch
#èŠ‚ç‚¹åç§°ï¼Œå¿…é¡»ä¸ä¸€æ ·
node.name: node-1
#å¿…é¡»ä¸ºæœ¬æœºçš„ipåœ°å€
network.host: 127.0.0.1
#æœåŠ¡ç«¯å£å·ï¼Œåœ¨åŒä¸€æœºå™¨ä¸‹å¿…é¡»ä¸ä¸€æ ·
http.port: 9200
#é›†ç¾¤é—´é€šä¿¡ç«¯å£å·ï¼Œåœ¨åŒä¸€æœºå™¨ä¸‹å¿…é¡»ä¸ä¸€æ ·
transport.tcp.port: 9300
#è®¾ç½®é›†ç¾¤è‡ªåŠ¨å‘ç°æœºå™¨ipé›†åˆ
discovery.zen.ping.unicast.hosts: [&quot;127.0.0.1:9300&quot;,&quot;127.0.0.1:9301&quot;,&quot;127.0.0.1:9302&quot;]
</code></pre>
<h5 id="node2èŠ‚ç‚¹">node2èŠ‚ç‚¹ï¼š</h5>
<pre><code class="language-yaml">#èŠ‚ç‚¹3çš„é…ç½®ä¿¡æ¯ï¼š
#é›†ç¾¤åç§°ï¼Œä¿è¯å”¯ä¸€
cluster.name: my-elasticsearch
#èŠ‚ç‚¹åç§°ï¼Œå¿…é¡»ä¸ä¸€æ ·
node.name: node-2
#å¿…é¡»ä¸ºæœ¬æœºçš„ipåœ°å€
network.host: 127.0.0.1
#æœåŠ¡ç«¯å£å·ï¼Œåœ¨åŒä¸€æœºå™¨ä¸‹å¿…é¡»ä¸ä¸€æ ·
http.port: 9201
#é›†ç¾¤é—´é€šä¿¡ç«¯å£å·ï¼Œåœ¨åŒä¸€æœºå™¨ä¸‹å¿…é¡»ä¸ä¸€æ ·
transport.tcp.port: 9301
#è®¾ç½®é›†ç¾¤è‡ªåŠ¨å‘ç°æœºå™¨ipé›†åˆ
discovery.zen.ping.unicast.hosts: [&quot;127.0.0.1:9300&quot;,&quot;127.0.0.1:9301&quot;,&quot;127.0.0.1:9302&quot;]
</code></pre>
<h5 id="node3èŠ‚ç‚¹">node3èŠ‚ç‚¹ï¼š</h5>
<pre><code class="language-yaml">#èŠ‚ç‚¹3çš„é…ç½®ä¿¡æ¯ï¼š
#é›†ç¾¤åç§°ï¼Œä¿è¯å”¯ä¸€
cluster.name: my-elasticsearch
#èŠ‚ç‚¹åç§°ï¼Œå¿…é¡»ä¸ä¸€æ ·
node.name: node-3
#å¿…é¡»ä¸ºæœ¬æœºçš„ipåœ°å€
network.host: 127.0.0.1
#æœåŠ¡ç«¯å£å·ï¼Œåœ¨åŒä¸€æœºå™¨ä¸‹å¿…é¡»ä¸ä¸€æ ·
http.port: 9202
#é›†ç¾¤é—´é€šä¿¡ç«¯å£å·ï¼Œåœ¨åŒä¸€æœºå™¨ä¸‹å¿…é¡»ä¸ä¸€æ ·
transport.tcp.port: 9302
#è®¾ç½®é›†ç¾¤è‡ªåŠ¨å‘ç°æœºå™¨ipé›†åˆ
discovery.zen.ping.unicast.hosts: [&quot;127.0.0.1:9300&quot;,&quot;127.0.0.1:9301&quot;,&quot;127.0.0.1:9302&quot;]
</code></pre>
<h4 id="å¯åŠ¨å„ä¸ªèŠ‚ç‚¹æœåŠ¡å™¨">å¯åŠ¨å„ä¸ªèŠ‚ç‚¹æœåŠ¡å™¨</h4>
<p>åŒå‡»elasticsearch-cluster\node*\bin\elasticsearch.bat</p>
<h4 id="é›†ç¾¤æµ‹è¯•">é›†ç¾¤æµ‹è¯•</h4>
<h5 id="æ·»åŠ ç´¢å¼•å’Œæ˜ å°„">æ·»åŠ ç´¢å¼•å’Œæ˜ å°„</h5>
<pre><code class="language-curl">curl  put  http://127.0.0.1:9200/blog1
</code></pre>
<p>body</p>
<pre><code class="language-json">{
    &quot;mappings&quot;: {
        &quot;article&quot;: {
            &quot;properties&quot;: {
                &quot;id&quot;: {
                 &quot;type&quot;: &quot;long&quot;,    
                    &quot;store&quot;: true,
                    &quot;index&quot;:&quot;not_analyzed&quot;
                },
                &quot;title&quot;: {
                 &quot;type&quot;: &quot;text&quot;,    
                    &quot;store&quot;: true,
                    &quot;index&quot;:&quot;analyzed&quot;,
                    &quot;analyzer&quot;:&quot;ik_max_word&quot;
                },
                &quot;content&quot;: {
                 &quot;type&quot;: &quot;text&quot;,    
                    &quot;store&quot;: true,
                    &quot;index&quot;:&quot;analyzed&quot;,
                    &quot;analyzer&quot;:&quot;ik_max_word&quot;
                }
            }
        }
    }
}
</code></pre>
<h5 id="æ·»åŠ æ–‡æ¡£">æ·»åŠ æ–‡æ¡£</h5>
<pre><code class="language-curl">curl  post  http://127.0.0.1:9200/blog1/article/1
</code></pre>
<p>body</p>
<pre><code class="language-json">{
	&quot;id&quot;:1,    
	&quot;title&quot;:&quot;ElasticSearchæ˜¯ä¸€ä¸ªåŸºäºLuceneçš„æœç´¢æœåŠ¡å™¨&quot;,    
	&quot;content&quot;:&quot;å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäºRESTful webæ¥å£ã€‚Elasticsearchæ˜¯ç”¨Javaå¼€å‘çš„ï¼Œå¹¶ä½œä¸ºApacheè®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯å½“å‰æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚è®¾è®¡ç”¨äºäº‘è®¡ç®—ä¸­ï¼Œèƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿ã€‚&quot; 
}
</code></pre>
<p>response</p>
<pre><code class="language-json">{
    &quot;_index&quot;: &quot;blog1&quot;,
    &quot;_type&quot;: &quot;article&quot;,
    &quot;_id&quot;: &quot;1&quot;,
    &quot;_version&quot;: 1,
    &quot;result&quot;: &quot;created&quot;,
    &quot;_shards&quot;: {
        &quot;total&quot;: 2,
        &quot;successful&quot;: 1,
        &quot;failed&quot;: 0
    },
    &quot;created&quot;: true
}
</code></pre>
<h4 id="ä½¿ç”¨elasticsearch-headeræŸ¥çœ‹é›†ç¾¤æƒ…å†µ">ä½¿ç”¨elasticsearch-headeræŸ¥çœ‹é›†ç¾¤æƒ…å†µ</h4>
<figure data-type="image" tabindex="5"><img src="https://haohanya.github.io/post-images/1594482511226.png" alt="" loading="lazy"></figure>
<p>å¦‚æœåˆ†ç‰‡å‰¯æœ¬å‡ºç°UNASSIGNEDå¯èƒ½åŸå› æ˜¯é…ç½®å‡ºé”™æˆ–è€…æ˜¯ç¡¬ç›˜ä½¿ç”¨ç‡å¤§äº80%ï¼Œå¯ä»¥è°ƒæ•´ä½¿ç”¨ç‡æ¥è§£å†³</p>
<pre><code class="language-curl">curl put http://127.0.0.1:9200/_cluster/settings
</code></pre>
<p>body</p>
<pre><code class="language-json">{
    &quot;transient&quot;: {
        &quot;cluster.routing.allocation.disk.watermark.low&quot;: &quot;95%&quot;
    }
}
</code></pre>

<span id="footnote"></span>
<div id = "warn"></div>
</div>
<div class="toc-container"><ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#elasticsearch%E7%AE%80%E4%BB%8B">ElasticSearchç®€ä»‹</a>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AFelasticsearch">ä»€ä¹ˆæ˜¯ElasticSearch</a></li>
<li><a href="#elasticsearch%E7%9A%84%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B">ElasticSearchçš„ä½¿ç”¨æ¡ˆä¾‹</a></li>
<li><a href="#elasticsearch%E5%AF%B9%E6%AF%94solr">ElasticSearchå¯¹æ¯”Solr</a></li>
</ul>
</li>
<li><a href="#elasticsearch%E5%AE%89%E8%A3%85%E4%B8%8E%E5%90%AF%E5%8A%A8">ElasticSearchå®‰è£…ä¸å¯åŠ¨</a>
<ul>
<li><a href="#%E4%B8%8B%E8%BD%BDes%E5%8E%8B%E7%BC%A9%E5%8C%85">ä¸‹è½½ESå‹ç¼©åŒ…</a></li>
<li><a href="#%E5%AE%89%E8%A3%85es%E6%9C%8D%E5%8A%A1">å®‰è£…ESæœåŠ¡</a></li>
<li><a href="#%E5%90%AF%E5%8A%A8es%E6%9C%8D%E5%8A%A1">å¯åŠ¨ESæœåŠ¡</a></li>
<li><a href="#%E5%AE%89%E8%A3%85es%E7%9A%84%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2%E6%8F%92%E4%BB%B6">å®‰è£…ESçš„å›¾å½¢åŒ–ç•Œé¢æ’ä»¶</a></li>
</ul>
</li>
<li><a href="#elasticsearch%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5%E6%9C%AF%E8%AF%AD">ElasticSearchç›¸å…³æ¦‚å¿µ(æœ¯è¯­)</a>
<ul>
<li><a href="#%E6%A6%82%E8%BF%B0">æ¦‚è¿°</a></li>
<li><a href="#elasticsearch%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5">Elasticsearchæ ¸å¿ƒæ¦‚å¿µ</a>
<ul>
<li><a href="#%E7%B4%A2%E5%BC%95-index">ç´¢å¼• index</a></li>
<li><a href="#%E7%B1%BB%E5%9E%8B-type">ç±»å‹ type</a></li>
<li><a href="#%E5%AD%97%E6%AE%B5field">å­—æ®µField</a></li>
<li><a href="#%E6%98%A0%E5%B0%84-mapping">æ˜ å°„ mapping</a></li>
<li><a href="#%E6%96%87%E6%A1%A3-document">æ–‡æ¡£ document</a></li>
<li><a href="#%E6%8E%A5%E8%BF%91%E5%AE%9E%E6%97%B6-nrt">æ¥è¿‘å®æ—¶ NRT</a></li>
<li><a href="#%E9%9B%86%E7%BE%A4-cluster">é›†ç¾¤ cluster</a></li>
<li><a href="#%E8%8A%82%E7%82%B9-node">èŠ‚ç‚¹ node</a></li>
<li><a href="#%E5%88%86%E7%89%87%E5%92%8C%E5%A4%8D%E5%88%B6-shardsreplicas">åˆ†ç‰‡å’Œå¤åˆ¶ shards&amp;replicas</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#elasticsearch%E7%9A%84%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%93%8D%E4%BD%9C">ElasticSearchçš„å®¢æˆ·ç«¯æ“ä½œ</a>
<ul>
<li><a href="#%E4%B8%8B%E8%BD%BDpostman">ä¸‹è½½PostMan</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8postman%E5%B7%A5%E5%85%B7%E8%BF%9B%E8%A1%8Crestful%E6%8E%A5%E5%8F%A3%E8%AE%BF%E9%97%AE">ä½¿ç”¨Postmanå·¥å…·è¿›è¡ŒRestfulæ¥å£è®¿é—®</a>
<ul>
<li><a href="#elasticsearch%E7%9A%84%E6%8E%A5%E5%8F%A3%E8%AF%AD%E6%B3%95">ElasticSearchçš„æ¥å£è¯­æ³•</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95index%E5%92%8C%E6%98%A0%E5%B0%84mapping">åˆ›å»ºç´¢å¼•indexå’Œæ˜ å°„mapping</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95%E5%90%8E%E8%AE%BE%E7%BD%AEmapping">åˆ›å»ºç´¢å¼•åè®¾ç½®Mapping</a></li>
<li><a href="#%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95index">åˆ é™¤ç´¢å¼•index</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E6%96%87%E6%A1%A3document">åˆ›å»ºæ–‡æ¡£document</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E6%96%87%E6%A1%A3document">ä¿®æ”¹æ–‡æ¡£document</a></li>
<li><a href="#%E5%88%A0%E9%99%A4%E6%96%87%E6%A1%A3document">åˆ é™¤æ–‡æ¡£document</a></li>
<li><a href="#%E6%9F%A5%E8%AF%A2%E6%96%87%E6%A1%A3-%E6%A0%B9%E6%8D%AEid%E6%9F%A5%E8%AF%A2">æŸ¥è¯¢æ–‡æ¡£-æ ¹æ®idæŸ¥è¯¢</a></li>
<li><a href="#%E6%9F%A5%E8%AF%A2%E6%96%87%E6%A1%A3-querystring%E6%9F%A5%E8%AF%A2">æŸ¥è¯¢æ–‡æ¡£-querystringæŸ¥è¯¢</a></li>
<li><a href="#%E6%9F%A5%E8%AF%A2%E6%96%87%E6%A1%A3-term%E6%9F%A5%E8%AF%A2">æŸ¥è¯¢æ–‡æ¡£-termæŸ¥è¯¢</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#elasticsearch%E9%9B%86%E6%88%90ik-%E5%88%86%E8%AF%8D%E5%99%A8">ElasticSearché›†æˆIK åˆ†è¯å™¨</a>
<ul>
<li><a href="#%E4%B8%8A%E8%BF%B0%E6%9F%A5%E8%AF%A2%E5%AD%98%E5%9C%A8%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90">ä¸Šè¿°æŸ¥è¯¢å­˜åœ¨é—®é¢˜åˆ†æ</a></li>
<li><a href="#ik%E5%88%86%E8%AF%8D%E5%99%A8%E7%AE%80%E4%BB%8B">IKåˆ†è¯å™¨ç®€ä»‹</a></li>
<li><a href="#elasticsearch%E9%9B%86%E6%88%90ik%E5%88%86%E8%AF%8D%E5%99%A8">ElasticSearché›†æˆIKåˆ†è¯å™¨</a>
<ul>
<li><a href="#ik%E5%88%86%E8%AF%8D%E5%99%A8%E7%9A%84%E5%AE%89%E8%A3%85">IKåˆ†è¯å™¨çš„å®‰è£…</a></li>
<li><a href="#ik%E5%88%86%E8%AF%8D%E5%99%A8%E6%B5%8B%E8%AF%95">IKåˆ†è¯å™¨æµ‹è¯•</a>
<ul>
<li><a href="#1-%E6%9C%80%E5%B0%8F%E5%88%87%E5%88%86">1ã€æœ€å°åˆ‡åˆ†</a></li>
<li><a href="#2-%E6%9C%80%E7%BB%86%E5%88%87%E5%88%86">2ã€æœ€ç»†åˆ‡åˆ†</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E4%BF%AE%E6%94%B9%E7%B4%A2%E5%BC%95%E6%98%A0%E5%B0%84mapping">ä¿®æ”¹ç´¢å¼•æ˜ å°„mapping</a>
<ul>
<li><a href="#%E9%87%8D%E5%BB%BA%E7%B4%A2%E5%BC%95">é‡å»ºç´¢å¼•</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E6%96%87%E6%A1%A3">åˆ›å»ºæ–‡æ¡£</a></li>
<li><a href="#%E6%B5%8B%E8%AF%95querystring%E6%9F%A5%E8%AF%A2">æµ‹è¯•queryStringæŸ¥è¯¢</a></li>
<li><a href="#term%E6%B5%8B%E8%AF%95">termæµ‹è¯•</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#elasticsearch%E9%9B%86%E7%BE%A4">ElasticSearché›†ç¾¤</a>
<ul>
<li><a href="#%E9%9B%86%E7%BE%A4%E7%9A%84%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5">é›†ç¾¤çš„ç›¸å…³æ¦‚å¿µ</a>
<ul>
<li><a href="#%E9%9B%86%E7%BE%A4-cluster-2">é›†ç¾¤ cluster</a></li>
<li><a href="#%E8%8A%82%E7%82%B9-node-2">èŠ‚ç‚¹ node</a></li>
<li><a href="#%E5%88%86%E7%89%87%E5%92%8C%E5%A4%8D%E5%88%B6-shardsreplicas-2">åˆ†ç‰‡å’Œå¤åˆ¶ shards&amp;replicas</a></li>
</ul>
</li>
<li><a href="#%E9%9B%86%E7%BE%A4%E7%9A%84%E6%90%AD%E5%BB%BA">é›†ç¾¤çš„æ­å»º</a>
<ul>
<li><a href="#%E5%87%86%E5%A4%87%E4%B8%89%E5%8F%B0elasticsearch%E6%9C%8D%E5%8A%A1%E5%99%A8">å‡†å¤‡ä¸‰å°elasticsearchæœåŠ¡å™¨</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E6%AF%8F%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE">ä¿®æ”¹æ¯å°æœåŠ¡å™¨é…ç½®</a>
<ul>
<li><a href="#node1%E8%8A%82%E7%82%B9">node1èŠ‚ç‚¹ï¼š</a></li>
<li><a href="#node2%E8%8A%82%E7%82%B9">node2èŠ‚ç‚¹ï¼š</a></li>
<li><a href="#node3%E8%8A%82%E7%82%B9">node3èŠ‚ç‚¹ï¼š</a></li>
</ul>
</li>
<li><a href="#%E5%90%AF%E5%8A%A8%E5%90%84%E4%B8%AA%E8%8A%82%E7%82%B9%E6%9C%8D%E5%8A%A1%E5%99%A8">å¯åŠ¨å„ä¸ªèŠ‚ç‚¹æœåŠ¡å™¨</a></li>
<li><a href="#%E9%9B%86%E7%BE%A4%E6%B5%8B%E8%AF%95">é›†ç¾¤æµ‹è¯•</a>
<ul>
<li><a href="#%E6%B7%BB%E5%8A%A0%E7%B4%A2%E5%BC%95%E5%92%8C%E6%98%A0%E5%B0%84">æ·»åŠ ç´¢å¼•å’Œæ˜ å°„</a></li>
<li><a href="#%E6%B7%BB%E5%8A%A0%E6%96%87%E6%A1%A3">æ·»åŠ æ–‡æ¡£</a></li>
</ul>
</li>
<li><a href="#%E4%BD%BF%E7%94%A8elasticsearch-header%E6%9F%A5%E7%9C%8B%E9%9B%86%E7%BE%A4%E6%83%85%E5%86%B5">ä½¿ç”¨elasticsearch-headeræŸ¥çœ‹é›†ç¾¤æƒ…å†µ</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="fullPage"><canvas id="canvas"></canvas></div>
</article>
<div id="eof"><span>EOF</span></div><div class="round-shape-one"></div>
<section>
<div class="doc_comments">

</div></section>
</div></div></div><script>
"use strict";!function(){for(var n=document.getElementsByTagName("pre"),e=n.length,s=0;s<e;s++){n[s].innerHTML='<span class="line-number"></span>'+n[s].innerHTML+'<span class="cl"></span>';for(var a=n[s].innerHTML.split(/\n/).length,r=0;r<a-1;r++){n[s].getElementsByTagName("span")[0].innerHTML+="<span>"+(r+1)+"</span>"}}}();
let mainNavLinks=document.querySelectorAll(".markdownIt-TOC a");window.addEventListener("scroll",event=>{let fromTop=window.scrollY;mainNavLinks.forEach((link,index)=>{let section=document.getElementById(decodeURI(link.hash).substring(1));let nextSection=null
if(mainNavLinks[index+1]){nextSection=document.getElementById(decodeURI(mainNavLinks[index+1].hash).substring(1));}
if(section.offsetTop<=fromTop){if(nextSection){if(nextSection.offsetTop>fromTop){link.classList.add("currentToc");}else{link.classList.remove("currentToc");}}else{link.classList.add("currentToc");}}else{link.classList.remove("currentToc");}});});
var list=document.querySelectorAll(".katex");for(var i=0;i<list.length;i++){list[i].style.display="unset"};
var h=document.documentElement,b=document.body,st="scrollTop",sh="scrollHeight",progress=document.querySelector(".progress"),scroll;document.addEventListener("scroll",function(){scroll=(h[st]||b[st])/((h[sh]||b[sh])-h.clientHeight)*100;progress.style.setProperty("--scroll",scroll+"%")});
var wxScale=new WxScale({fullPage:document.querySelector("#fullPage"),canvas:document.querySelector("#canvas")});var imgBox=document.querySelectorAll("#md_block img");for(var i=0;i<imgBox.length;i++){imgBox[i].onclick=function(e){wxScale.start(this)}};
content="æœ¬æ–‡æœ€åæ›´æ–°äº2020-07-11ï¼Œå·²è¶…è¿‡ 1 å¹´æ²¡æœ‰æ›´æ–°ï¼Œæ¶‰åŠçš„å†…å®¹å¯èƒ½å·²ç»å¤±æ•ˆï¼";var date1="2020-07-11 23:43:04";date1=date1.replace("-","/");var date2=new Date();var date3=date2.getTime()-new Date(date1).getTime();var days=Math.floor(date3/(24*3600*1000));if(days>=365){document.getElementById("warn").innerHTML=content};
</script>
<style>#magnifyImg{position:fixed;left:0;top:0;text-align:center;width:100%;display:none;z-index:9999}#magnifyImg img{object-fit:contain;background:#eaecef;padding:15px;border-radius:10px;height:auto;width:auto;vertical-align:middle}</style>
<a id="scrollUp" href="#top" style="position: fixed; z-index: 2147483647; display: block;"></a>
<div class="footer animated fadeInDown">
    <div class="site_footer">
        <div class="mysocials">
            <div class="my_socials">
                <a
                    href="admin@soweat.cn" title="envelope"><i
                        class="iconfont icon-envelope"></i></a></div>
        </div>
        <div class="copyright" id="copyright">Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>Copyright Â© 2018-2020 <a
                href="https://haohanya.github.io" style="margin:0;">æµ©ç€š</a>.</div>
        <span style="display: inline;margin-right:15px;">ğŸ‘<strong><span
                    id="busuanzi_value_site_uv"></span></strong></span><span id="busuanzi_container_page_pv"
            style="display: inline;"><span>ğŸ“š<strong>24</strong> posts</span>
    </div>
</div>
<script>
    console.log("\n %c \u26a1Theme: Bitcron-pro Author's Blog:https://blog.blinkstar.cn  Writen By Serence  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;",);
</script>
<script src="https://cdn.jsdelivr.net/npm/instant.page@3.0.0/instantpage.min.js" type="module" defer></script>
<script type="text/javascript" async src="https://haohanya.github.io/media/js/prism.js"></script>
</body>
</html>